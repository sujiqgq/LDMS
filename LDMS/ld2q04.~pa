//==============================================================================
// 프로그램 설명 : RIA분주현황
// 시스템        : 통합검진
// 수정일자      : 2005.11.14
// 수정자        : 유동구
// 수정내용      : 새롭게 개발..
// 참고사항      :
//==============================================================================
// 프로그램 설명 : 외주항목 List (분주실 전용)
// 시스템        : 통합검진
// 수정일자      : 2006.04.11
// 수정자        : 김승철
//==============================================================================
// 수정일자      : 2006.06.26
// 수정자        : 김승철
// 수정내용      : E008, E022, E027 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2006.09.11
// 수정자        : 김승철
// 수정내용      : E045 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2007.01.24
// 수정자        : 유동구
// 수정내용      : C070,C065,E019,SE11,SE12,T005,S080,C020 추가
// 참고사항      : 출력은 별도 제작해서 총 2두장으로 출력..
//==============================================================================
// 수정일자      : 2007.06.21
// 수정자        : 구수정
// 수정내용      : 007 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2008.05.18
// 수정자        : 송재호
// 수정내용      : C015를 E005로 변경
// 참고사항      :
//==============================================================================
// 수정일자      : 2008.07.09
// 수정자        : 송재호
// 수정내용      : T005,T024 삭제 및 S014,S015 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2008.11.07
// 수정자        : 송재호
// 수정내용      : E005를 S009로 변경
// 참고사항      :
//==============================================================================
// 수정일자      : 2009.02.09
// 수정자        : 김승철
// 수정내용      : C076 추가.
// 참고사항      :
//==============================================================================
// 수정일자      : 2009.05.09
// 수정자        : 송재호
// 수정내용      : E050, U039, U040, U041 추가.
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.03.08
// 수정자        : 송재호
// 수정내용      : E008->C081, E022->T038, E027,E045, S014, S015, C031 삭제
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.04.16
// 수정자        : 정용수
// 수정내용      : T034 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.05.11
// 수정자        : 정용수
// 수정내용      : T005 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.05.11
// 수정자        : 정용수
// 수정내용      : S022 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.06.29
// 수정자        : 김희석
// 수정내용      : E049,E005 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.07.08
// 수정자        : 김희석
// 수정내용      : T039추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.08.04
// 수정자        : 정용수
// 수정내용      : C035삭제 U034추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.09.04
// 수정자        : 김희석
// 수정내용      :  CO40 삭제 P008 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.10.21
// 수정자        : 정용수
// 수정내용      : SE11 -> SE16
// 참고사항      :
//==============================================================================
// 수정일자      : 2010.12.07
// 수정자        : 김희석
// 수정내용      : S086,S087,S088,S089
// 참고사항      :
//==============================================================================
// 수정일자      : 2011.04.04
// 수정자        : 김희석
// 수정내용      : S064 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2011.06.10
// 수정자        : 송재호
// 수정내용      : S009, C037, E041, T034, S010 삭제
// 참고사항      :
//==============================================================================
// 수정일자      : 2011.09.29
// 수정자        : 송재호
// 수정내용      : C065, C072, C079, S059, S060, S061, S062, S063, S070, S081, S082, S030, S031, S032, T018, T019, T021, T022, T023, T024, C071, E047,
//                 S076, S077, S078, S079, S085, SE26, SE27, SE28, SE29, T025, T026, T027, T028, T032, T033, T035, T036, H027, H028 추가
// 참고사항      : 한의 재단분주팀1100055
//==============================================================================
// 수정일자      : 2011.12.01
// 수정자        : 송재호
// 수정내용      : S090 추가
// 참고사항      : 한의 재단분주팀1100074
//==============================================================================
// 수정일자      : 2012.05.07
// 수정자        : 김승철
// 수정내용      : 알레르기(S079, S090)외주에서 빠지고 다른항목으로 변경. S079 -> E012, S090 -> E014
// 참고사항      :
//==============================================================================
// 수정일자      : 2012.07.3
// 수정자        : 김희석
// 수정내용      : E059~E065 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2012.07.10
// 수정자        : 김희석
// 수정내용      : T044~T048 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2012.08.16
// 수정자        : 김희석
// 수정내용      : T049 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2012.08.24
// 수정자        : 김희석
// 수정내용      : U048 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2014.03.24
// 수정자        : 곽윤설
// 수정내용      : T012, S018, S019, C070 제거
// 참고사항      :
//==============================================================================
// 수정일자      : 2014.04.07
// 수정자        : 곽윤설
// 수정내용      : SE13제거, T043추가
// 참고사항      : 엑셀 SBut_Excel(ComObj) 추가
//==============================================================================
// 수정일자      : 2014.05.10
// 수정자        : 곽윤설
// 수정내용      : S082 -> S098 변경 (CKMS상에 S082가 미사용 코드)
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.05.10
// 수정자        : 곽윤설
// 수정내용      : Y005, Y008 추가, U057삭제
// 참고사항      :
//==============================================================================
// 수정일자      : 2014.06.21
// 수정자        : 곽윤설
// 수정내용      : SE12->C038 / C071->S094 / T025->S095로 코드 변경
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.07.23
// 수정자        : 곽윤설
// 수정내용      : DRUC, C054, S096, S097 추가 (DRUC는 14파트, 검진일로 조회)
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.08.30
// 수정자        : 곽윤설
// 수정내용      : T043 삭제
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.09.04
// 수정자        : 곽윤설
// 수정내용      : T039 삭제
// 참고사항      : [본원-한두례]
//==============================================================================
// 수정일자      : 2014.11.08
// 수정자        : 곽윤설
// 수정내용      : S064 삭제
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.11.14
// 수정자        : 곽윤설
// 수정내용      : T051 T052 T053 T054 추가
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2014.11.15
// 수정자        : 곽윤설
// 수정내용      : T055 추가
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2015.02.12
// 수정자        : 곽윤설
// 수정내용      :  해당 단체코드에 대해 C031,C022,C023 코드 조회 가능하도록 수정
//                  432080,432082,432871,432083,432081,432079,431953,430520,431343,430513,431062,431314,
//                  433141,430616,431186,432878,432129,431525,431524,432482,431182,431343,614135,516311
// 참고사항      : [본원-최정미]
//                  2015.02.14 백승현 C031이 아니라 C080임 최정미 선임이 잘못 알려줌. C031을 C080으로 수정함
//==============================================================================
// 수정일자      : 2015.03.10
// 수정자        : 곽윤설
// 수정내용      :  해당 단체코드에 대해 C080,C022,C023 코드 조회 가능하도록 수정
//                  153899, 001880, 000890, 153910
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2015.04.02
// 수정자        : 곽윤설
// 수정내용      :  해당 단체코드에 대해 C080,C022,C023 코드 조회 가능하도록 수정
//                  117142,119332,116681   + 2015.04.07 122991, 614023, 516023 추가
// 참고사항      : [본원-최정미]           + 2015.04.07 510155, 513141 추가
//==============================================================================
// 수정일자      : 2015.04.11
// 수정자        : 곽윤설
// 수정내용      :  U015, U016 추가
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2015.04.14
// 수정자        : 곽윤설
// 수정내용      : T009, T012 모든 사업장 조회가능하도록 수정.
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2015.04.30
// 수정자        : 곽윤설
// 수정내용      : C022, C023, C080 코드삭제
// 참고사항      : 한의 재단진단검사의학팀1500363 [본원-최정미]
//==============================================================================
// 수정일자      : 2015.07.29
// 수정자        : 곽윤설
// 수정내용      : T056, T057 추가
// 참고사항      : [본원-박연숙]
//==============================================================================
// 수정일자      : 2016.01.13
// 수정자        : 박수지
// 수정내용      : H046추가
// 참고사항      : 한의 재단진단검사의학팀1600023
//==============================================================================
// 수정일자      : 2016.04.01
// 수정자        : 박수지
// 수정내용      : P007, P008 씨젠 외주로 옮김 , S100(말벌독 추가)
// 참고사항      :
//==============================================================================
// 수정일자      : 2016.08.08
// 수정자        : 박수지
// 수정내용      : C020 자체검사로 리스트 항목 삭제
// 참고사항      :
//==============================================================================
// 수정일자      : 2016.11.02
// 수정자        : 박수지
// 수정내용      : t030 리스트 추가
// 참고사항      : 한의 재단진단검사의학팀 1600897
//==============================================================================
// 수정일자      : 2016.11.02
// 수정자        : 박수지
// 수정내용      : t059리스트 추가
// 참고사항      : 한의 재단진단검사의학팀 1600995
//==============================================================================
// 수정일자      : 2017.06.01
// 수정자        : 박수지
// 수정내용      : T049리스트 제외
// 참고사항      : 
//==============================================================================
// 수정일자      : 2017.08.09
// 수정자        : 박수지
// 수정내용      :
// 참고사항      :
//==============================================================================
unit LD2Q04;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  ORSingle, Menus, Buttons, ComCtrls, ToolWin, Db, DBTables, Grids, DBGrids,
  Grids_ts, TSGrid, ExtCtrls, StdCtrls, Mask, DateEdit, DdeMan, Gauges,
  QuickRpt, ComObj;

type
  TfrmLD2Q04 = class(TfrmSingle)
    grdMaster: TtsGrid;
    pnlCond: TPanel;
    Label7: TLabel;
    cmbJisa: TComboBox;
    Label2: TLabel;
    Label3: TLabel;
    btnBdate: TSpeedButton;
    Label5: TLabel;
    edtBDate: TDateEdit;
    bunjuno1: TEdit;
    bunjuno2: TEdit;
    qryBunju: TQuery;
    RBtn_preveiw: TRadioButton;
    RBtn_print: TRadioButton;
    Gride: TGauge;
    qryPf_hm: TQuery;
    edtDESC_DC: TEdit;
    btnDc: TSpeedButton;
    edtDc: TEdit;
    Label1: TLabel;
    QRCompositeReport: TQRCompositeReport;
    RadioGroup1: TRadioGroup;
    Btn_NamePrint: TBitBtn;
    RBtn_1: TRadioButton;
    RBtn_2: TRadioButton;
    qryProfile: TQuery;
    qryTkgum: TQuery;
    qryNo_hangmok: TQuery;
    SBut_Excel: TSpeedButton;
    Gauge2: TGauge;
    procedure FormCreate(Sender: TObject);
    procedure grdMasterCellLoaded(Sender: TObject; DataCol,
      DataRow: Integer; var Value: Variant);
    procedure btnQueryClick(Sender: TObject);
    procedure UP_KeyUp(Sender: TObject; var Key: Word; Shift: TShiftState);
    procedure UP_Change(Sender: TObject);
    procedure UP_Click(Sender: TObject);
    procedure btnPrintClick(Sender: TObject);
    procedure FormActivate(Sender: TObject);
    procedure MouseWheelHandler(var Message: TMessage); override;
    procedure QRCompositeReportAddReports(Sender: TObject);
    procedure Btn_NamePrintClick(Sender: TObject);
    function  UF_hangmokList : String;
    function  UF_No_Hangmok(sDate, sGubun : String; iYh : Integer): String;
    procedure SBut_ExcelClick(Sender: TObject);
    private
    { Private declarations }
    // Grid와 연관된 Variant 변수 선언
    UV_vNo, UV_vName, UV_vJumin, UV_vJisa, UV_vBUN, UV_vE021, UV_vS055, UV_vS066, 
    UV_vU034, UV_vE016, UV_vC081, UV_vT038, UV_vDesc_dc, UV_vE019, UV_vSE16, UV_vC038, UV_vS093,
    UV_vC020, UV_vS039,
    UV_vH038, UV_vH039, UV_vU049, UV_vY009, UV_vC075, UV_vH031, UV_vC076, UV_vE050, UV_vU039, UV_vU040, UV_vU041,
    UV_vSampNo,
    UV_vE051, UV_vE052, UV_vE053, UV_vE054, UV_vE055, UV_vE056, UV_vE057, UV_vE058, UV_vT005, UV_vS022,UV_vE049, UV_vS086,
    UV_vS087, UV_vS088, UV_vS089, UV_vC036,

    UV_vC065, UV_vC072, UV_vC079, UV_vS059, UV_vS060, UV_vS061, UV_vS062, UV_vS063, UV_vS070, UV_vS081, UV_vS098,
    UV_vS030, UV_vS031, UV_vS032, UV_vT018, UV_vE013, UV_vT021, UV_vT022, UV_vT023, UV_vT024, UV_vS094, UV_vE047,
    UV_vS076, UV_vS077, UV_vS078, UV_vE012, UV_vS085, UV_vSE26, UV_vSE27, UV_vSE28, UV_vSE29, UV_vS095,
    UV_vT026, UV_vT027, UV_vT028, UV_vT032, UV_vT033, UV_vT035, UV_vT036, UV_vH027, UV_vH028, UV_vE014, UV_vE059,
    UV_vE060, UV_vE061, UV_vE062, UV_vE063, UV_vE064, UV_vE065, UV_vT044, UV_vT045, UV_vT046, UV_vT047, UV_vT048,
    UV_vE066, UV_vE067, UV_vT049, UV_vU048, UV_vS092, UV_vT050, UV_vC053, UV_vC055, UV_vT039,  UV_vU019,
    UV_vC018, UV_vE010, UV_vS023, UV_vS038, UV_vS040, UV_vS053, UV_vS054, UV_vSE38, UV_vC016,
    UV_vT015, UV_vS029, UV_vY005, UV_vY008, UV_vDRUC, UV_vC054, UV_vS096, UV_vS097, UV_vT051, UV_vT052, UV_vT053,
    UV_vT054, UV_vT055, UV_vU015, UV_vU016, UV_vT056, UV_vT057, UV_vH046, UV_vS100, UV_vT030, UV_vT059, UV_vS103,
    UV_vS105, UV_vS106, UV_vS107, UV_vS108, UV_vC044, UV_vS109, UV_vS110  : Variant;

    // 공통적으로 사용하는 함수(이름을 동일하게 사용)
    procedure UP_VarMemSet(iLength : Integer);
    function  UF_Condition : Boolean;
  public
    { Public declarations }
  end;

var
  frmLD2Q04: TfrmLD2Q04;

implementation

uses ZZFunc, ZZMenu, ZZComm, MdmsFunc, LD2Q041, LD2Q042, LD2Q043, LD2Q044, LD2Q046, LD2Q047, LD2Q048,LD2Q049, LD2Q0491, LD2Q0492,
  LD2Q045;

{$R *.DFM}

procedure TfrmLD2Q04.UP_KeyUp(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  inherited;
   if Key <> GC_Refer then exit;

   if Sender = edtDc then UP_Click(btnDC);

end;

procedure TfrmLD2Q04.MouseWheelHandler(var Message: TMessage);  //수정
begin
   if Message.msg = WM_MOUSEWHEEL then begin
      if (ActiveControl is Ttsgrid) then begin //수정
         if Message.wParam > 0 then
         keybd_event(VK_UP, VK_UP, 0, 0)
         else if Message.wParam < 0 then
         keybd_event(VK_DOWN, VK_DOWN, 0, 0);
         Application.ProcessMessages;//추가
         grdMaster.Refresh; //수정
      end;
   end;
end;

procedure TfrmLD2Q04.UP_VarMemSet(iLength : Integer);
begin
   // Variant Memory Allocation
   if iLength = 0 then
   begin
      // Variant변수를 사용하기 위해서 생성
      UV_vNo    := VarArrayCreate([0, 0], varOleStr);
      UV_vName  := VarArrayCreate([0, 0], varOleStr);
      UV_vJumin := VarArrayCreate([0, 0], varOleStr);
      UV_vJisa  := VarArrayCreate([0, 0], varOleStr);
      UV_vBUN   := VarArrayCreate([0, 0], varOleStr);

      UV_vE021  := VarArrayCreate([0, 0], varOleStr);
      UV_vS055  := VarArrayCreate([0, 0], varOleStr);
      UV_vS066  := VarArrayCreate([0, 0], varOleStr);
      UV_vU034  := VarArrayCreate([0, 0], varOleStr);

      UV_vE016  := VarArrayCreate([0, 0], varOleStr);
      UV_vC081  := VarArrayCreate([0, 0], varOleStr);
      UV_vT038  := VarArrayCreate([0, 0], varOleStr);
      UV_vE019  := VarArrayCreate([0, 0], varOleStr);
      UV_vSE16  := VarArrayCreate([0, 0], varOleStr);

      UV_vC038  := VarArrayCreate([0, 0], varOleStr);
      UV_vS093  := VarArrayCreate([0, 0], varOleStr);
      UV_vC020  := VarArrayCreate([0, 0], varOleStr);

      UV_vS039  := VarArrayCreate([0, 0], varOleStr);
      UV_vH038  := VarArrayCreate([0, 0], varOleStr);
      UV_vH039  := VarArrayCreate([0, 0], varOleStr);
      UV_vU049  := VarArrayCreate([0, 0], varOleStr);
      UV_vY009  := VarArrayCreate([0, 0], varOleStr);

      UV_vC075  := VarArrayCreate([0, 0], varOleStr);
      UV_vH031  := VarArrayCreate([0, 0], varOleStr);
      UV_vC076  := VarArrayCreate([0, 0], varOleStr);
      UV_vE050  := VarArrayCreate([0, 0], varOleStr);
      UV_vU039  := VarArrayCreate([0, 0], varOleStr);

      UV_vU040  := VarArrayCreate([0, 0], varOleStr);
      UV_vU041  := VarArrayCreate([0, 0], varOleStr);
      UV_vE051  := VarArrayCreate([0, 0], varOleStr);
      UV_vE052  := VarArrayCreate([0, 0], varOleStr);
      UV_vE053  := VarArrayCreate([0, 0], varOleStr);

      UV_vE054  := VarArrayCreate([0, 0], varOleStr);
      UV_vE055  := VarArrayCreate([0, 0], varOleStr);
      UV_vE056  := VarArrayCreate([0, 0], varOleStr);
      UV_vE057  := VarArrayCreate([0, 0], varOleStr);
      UV_vE058  := VarArrayCreate([0, 0], varOleStr);

      UV_vT005  := VarArrayCreate([0, 0], varOleStr);
      UV_vS022  := VarArrayCreate([0, 0], varOleStr);
      UV_vE049  := VarArrayCreate([0, 0], varOleStr);
      UV_vS086  := VarArrayCreate([0, 0], varOleStr);
      UV_vS087  := VarArrayCreate([0, 0], varOleStr);

      UV_vS088  := VarArrayCreate([0, 0], varOleStr);
      UV_vS089  := VarArrayCreate([0, 0], varOleStr);
      UV_vC036  := VarArrayCreate([0, 0], varOleStr);
      UV_vC065  := VarArrayCreate([0, 0], varOleStr);
      UV_vC072  := VarArrayCreate([0, 0], varOleStr);

      UV_vC079  := VarArrayCreate([0, 0], varOleStr);
      UV_vS059  := VarArrayCreate([0, 0], varOleStr);
      UV_vS060  := VarArrayCreate([0, 0], varOleStr);
      UV_vS061  := VarArrayCreate([0, 0], varOleStr);
      UV_vS062  := VarArrayCreate([0, 0], varOleStr);

      UV_vS063  := VarArrayCreate([0, 0], varOleStr);
      UV_vS070  := VarArrayCreate([0, 0], varOleStr);
      UV_vS081  := VarArrayCreate([0, 0], varOleStr);
      UV_vS098  := VarArrayCreate([0, 0], varOleStr);
      UV_vS030  := VarArrayCreate([0, 0], varOleStr);

      UV_vS031  := VarArrayCreate([0, 0], varOleStr);
      UV_vS032  := VarArrayCreate([0, 0], varOleStr);
      UV_vT018  := VarArrayCreate([0, 0], varOleStr);
      UV_vE013  := VarArrayCreate([0, 0], varOleStr);
      UV_vT021  := VarArrayCreate([0, 0], varOleStr);

      UV_vT022  := VarArrayCreate([0, 0], varOleStr);
      UV_vT023  := VarArrayCreate([0, 0], varOleStr);
      UV_vT024  := VarArrayCreate([0, 0], varOleStr);
      UV_vS094  := VarArrayCreate([0, 0], varOleStr);
      UV_vE047  := VarArrayCreate([0, 0], varOleStr);

      UV_vS076  := VarArrayCreate([0, 0], varOleStr);
      UV_vS077  := VarArrayCreate([0, 0], varOleStr);
      UV_vS078  := VarArrayCreate([0, 0], varOleStr);
      UV_vE012  := VarArrayCreate([0, 0], varOleStr);
      UV_vS085  := VarArrayCreate([0, 0], varOleStr);

      UV_vSE26  := VarArrayCreate([0, 0], varOleStr);
      UV_vSE27  := VarArrayCreate([0, 0], varOleStr);
      UV_vSE28  := VarArrayCreate([0, 0], varOleStr);
      UV_vSE29  := VarArrayCreate([0, 0], varOleStr);
      UV_vS095  := VarArrayCreate([0, 0], varOleStr);

      UV_vT026  := VarArrayCreate([0, 0], varOleStr);
      UV_vT027  := VarArrayCreate([0, 0], varOleStr);
      UV_vT028  := VarArrayCreate([0, 0], varOleStr);
      UV_vT032  := VarArrayCreate([0, 0], varOleStr);
      UV_vT033  := VarArrayCreate([0, 0], varOleStr);

      UV_vT035  := VarArrayCreate([0, 0], varOleStr);
      UV_vT036  := VarArrayCreate([0, 0], varOleStr);
      UV_vH027  := VarArrayCreate([0, 0], varOleStr);
      UV_vH028  := VarArrayCreate([0, 0], varOleStr);
      UV_vE014  := VarArrayCreate([0, 0], varOleStr);

      UV_vE059  := VarArrayCreate([0, 0], varOleStr);
      UV_vE060  := VarArrayCreate([0, 0], varOleStr);
      UV_vE061  := VarArrayCreate([0, 0], varOleStr);
      UV_vE062  := VarArrayCreate([0, 0], varOleStr);
      UV_vE063  := VarArrayCreate([0, 0], varOleStr);

      UV_vE064  := VarArrayCreate([0, 0], varOleStr);
      UV_vE065  := VarArrayCreate([0, 0], varOleStr);
      UV_vT044  := VarArrayCreate([0, 0], varOleStr);
      UV_vT045  := VarArrayCreate([0, 0], varOleStr);
      UV_vT046  := VarArrayCreate([0, 0], varOleStr);

      UV_vT047  := VarArrayCreate([0, 0], varOleStr);
      UV_vT048  := VarArrayCreate([0, 0], varOleStr);
      UV_vE066  := VarArrayCreate([0, 0], varOleStr);
      UV_vE067  := VarArrayCreate([0, 0], varOleStr);
      UV_vT049  := VarArrayCreate([0, 0], varOleStr);

      UV_vU048  := VarArrayCreate([0, 0], varOleStr);
      UV_vS092  := VarArrayCreate([0, 0], varOleStr);
      UV_vT050  := VarArrayCreate([0, 0], varOleStr);
      UV_vC053  := VarArrayCreate([0, 0], varOleStr);
      UV_vC055  := VarArrayCreate([0, 0], varOleStr);

      UV_vT039  := VarArrayCreate([0, 0], varOleStr);
      UV_vU019  := VarArrayCreate([0, 0], varOleStr);

      UV_vC018  := VarArrayCreate([0, 0], varOleStr);
      UV_vE010  := VarArrayCreate([0, 0], varOleStr);
      UV_vS023  := VarArrayCreate([0, 0], varOleStr);
      UV_vS029  := VarArrayCreate([0, 0], varOleStr);
      UV_vS038  := VarArrayCreate([0, 0], varOleStr);

      UV_vS040  := VarArrayCreate([0, 0], varOleStr);
      UV_vS053  := VarArrayCreate([0, 0], varOleStr);
      UV_vS054  := VarArrayCreate([0, 0], varOleStr);
      UV_vSE38  := VarArrayCreate([0, 0], varOleStr);
      UV_vT015  := VarArrayCreate([0, 0], varOleStr);
      UV_vY005  := VarArrayCreate([0, 0], varOleStr);
      UV_vY008  := VarArrayCreate([0, 0], varOleStr);

      UV_vDRUC  := VarArrayCreate([0, 0], varOleStr);
      UV_vC054  := VarArrayCreate([0, 0], varOleStr);
      UV_vS096  := VarArrayCreate([0, 0], varOleStr);
      UV_vS097  := VarArrayCreate([0, 0], varOleStr);

      UV_vT051  := VarArrayCreate([0, 0], varOleStr);
      UV_vT052  := VarArrayCreate([0, 0], varOleStr);
      UV_vT053  := VarArrayCreate([0, 0], varOleStr);
      UV_vT054  := VarArrayCreate([0, 0], varOleStr);

      UV_vT055  := VarArrayCreate([0, 0], varOleStr);

      UV_vU015  := VarArrayCreate([0, 0], varOleStr);
      UV_vU016  := VarArrayCreate([0, 0], varOleStr);

      UV_vT056  := VarArrayCreate([0, 0], varOleStr);
      UV_vT057  := VarArrayCreate([0, 0], varOleStr);

      UV_vH046  := VarArrayCreate([0, 0], varOleStr);
      UV_vS100  := VarArrayCreate([0, 0], varOleStr);
      UV_vT030  := VarArrayCreate([0, 0], varOleStr);
      UV_vT059  := VarArrayCreate([0, 0], varOleStr);
      UV_vS103  := VarArrayCreate([0, 0], varOleStr);
      UV_vC016  := VarArrayCreate([0, 0], varOleStr);
      UV_vS105  := VarArrayCreate([0, 0], varOleStr);
      UV_vS106  := VarArrayCreate([0, 0], varOleStr);
      UV_vS107  := VarArrayCreate([0, 0], varOleStr);
      UV_vS108  := VarArrayCreate([0, 0], varOleStr);
      UV_vC044  := VarArrayCreate([0, 0], varOleStr);
      UV_vS109  := VarArrayCreate([0, 0], varOleStr);
      UV_vS110  := VarArrayCreate([0, 0], varOleStr);

      UV_vDesc_dc := VarArrayCreate([0, 0], varOleStr);
      UV_vSampNo  := VarArrayCreate([0, 0], varOleStr);
  end
   else
   begin
      // 이미 생성된 변수들의 크기를 조정
      VarArrayRedim(UV_vNo,    iLength);
      VarArrayRedim(UV_vName,  iLength);
      VarArrayRedim(UV_vJumin, iLength);
      VarArrayRedim(UV_vJisa,  iLength);
      VarArrayRedim(UV_vBUN,   iLength);
      VarArrayRedim(UV_vE021,  iLength);
      VarArrayRedim(UV_vS055,  iLength);
      VarArrayRedim(UV_vS066,  iLength);
      VarArrayRedim(UV_vU034,  iLength);
      VarArrayRedim(UV_vE016,  iLength);
      VarArrayRedim(UV_vC081,  iLength);
      VarArrayRedim(UV_vT038,  iLength);
      VarArrayRedim(UV_vE019,  iLength);
      VarArrayRedim(UV_vSE16,  iLength);
      VarArrayRedim(UV_vC038,  iLength);
      VarArrayRedim(UV_vS093,  iLength);
      VarArrayRedim(UV_vC020,  iLength);
      VarArrayRedim(UV_vS039,  iLength);
      VarArrayRedim(UV_vH038,  iLength);
      VarArrayRedim(UV_vH039,  iLength);
      VarArrayRedim(UV_vU049,  iLength);

      VarArrayRedim(UV_vY009,  iLength);
      VarArrayRedim(UV_vC075,  iLength);
      VarArrayRedim(UV_vH031,  iLength);
      VarArrayRedim(UV_vC076,  iLength);

      VarArrayRedim(UV_vE050,  iLength);
      VarArrayRedim(UV_vU039,  iLength);
      VarArrayRedim(UV_vU040,  iLength);
      VarArrayRedim(UV_vU041,  iLength);

      VarArrayRedim(UV_vE051,  iLength);
      VarArrayRedim(UV_vE052,  iLength);
      VarArrayRedim(UV_vE053,  iLength);
      VarArrayRedim(UV_vE054,  iLength);
      VarArrayRedim(UV_vE055,  iLength);
      VarArrayRedim(UV_vE056,  iLength);
      VarArrayRedim(UV_vE057,  iLength);
      VarArrayRedim(UV_vE058,  iLength);
      VarArrayRedim(UV_vT005,  iLength);
      VarArrayRedim(UV_vS022,  iLength);
      VarArrayRedim(UV_vE049,  iLength);
      VarArrayRedim(UV_vS086,  iLength);
      VarArrayRedim(UV_vS087,  iLength);
      VarArrayRedim(UV_vS088,  iLength);
      VarArrayRedim(UV_vS089,  iLength);
      VarArrayRedim(UV_vC036,  iLength);

      VarArrayRedim(UV_vC065,  iLength);
      VarArrayRedim(UV_vC072,  iLength);
      VarArrayRedim(UV_vC079,  iLength);
      VarArrayRedim(UV_vS059,  iLength);
      VarArrayRedim(UV_vS060,  iLength);
      VarArrayRedim(UV_vS061,  iLength);
      VarArrayRedim(UV_vS062,  iLength);
      VarArrayRedim(UV_vS063,  iLength);
      VarArrayRedim(UV_vS070,  iLength);
      VarArrayRedim(UV_vS081,  iLength);
      VarArrayRedim(UV_vS098,  iLength);
      VarArrayRedim(UV_vS030,  iLength);
      VarArrayRedim(UV_vS031,  iLength);
      VarArrayRedim(UV_vS032,  iLength);
      VarArrayRedim(UV_vT018,  iLength);
      VarArrayRedim(UV_vE013,  iLength);
      VarArrayRedim(UV_vT021,  iLength);
      VarArrayRedim(UV_vT022,  iLength);
      VarArrayRedim(UV_vT023,  iLength);
      VarArrayRedim(UV_vT024,  iLength);
      VarArrayRedim(UV_vS094,  iLength);
      VarArrayRedim(UV_vE047,  iLength);
      VarArrayRedim(UV_vS076,  iLength);
      VarArrayRedim(UV_vS077,  iLength);
      VarArrayRedim(UV_vS078,  iLength);
      VarArrayRedim(UV_vE012,  iLength);
      VarArrayRedim(UV_vS085,  iLength);
      VarArrayRedim(UV_vSE26,  iLength);
      VarArrayRedim(UV_vSE27,  iLength);
      VarArrayRedim(UV_vSE28,  iLength);
      VarArrayRedim(UV_vSE29,  iLength);
      VarArrayRedim(UV_vS095,  iLength);
      VarArrayRedim(UV_vT026,  iLength);
      VarArrayRedim(UV_vT027,  iLength);
      VarArrayRedim(UV_vT028,  iLength);
      VarArrayRedim(UV_vT032,  iLength);
      VarArrayRedim(UV_vT033,  iLength);
      VarArrayRedim(UV_vT035,  iLength);
      VarArrayRedim(UV_vT036,  iLength);
      VarArrayRedim(UV_vH027,  iLength);
      VarArrayRedim(UV_vH028,  iLength);
      VarArrayRedim(UV_vE014,  iLength);
      VarArrayRedim(UV_vE059,  iLength);
      VarArrayRedim(UV_vE060,  iLength);
      VarArrayRedim(UV_vE061,  iLength);
      VarArrayRedim(UV_vE062,  iLength);
      VarArrayRedim(UV_vE063,  iLength);
      VarArrayRedim(UV_vE064,  iLength);
      VarArrayRedim(UV_vE065,  iLength);

      VarArrayRedim(UV_vT044,  iLength);
      VarArrayRedim(UV_vT045,  iLength);
      VarArrayRedim(UV_vT046,  iLength);
      VarArrayRedim(UV_vT047,  iLength);
      VarArrayRedim(UV_vT048,  iLength);
      VarArrayRedim(UV_vE066,  iLength);
      VarArrayRedim(UV_vE067,  iLength);
      VarArrayRedim(UV_vT049,  iLength);
      VarArrayRedim(UV_vU048,  iLength);
      VarArrayRedim(UV_vS092,  iLength);
      VarArrayRedim(UV_vT050,  iLength);
      VarArrayRedim(UV_vC053,  iLength);
      VarArrayRedim(UV_vC055,  iLength);
      VarArrayRedim(UV_vT039,  iLength);
      VarArrayRedim(UV_vU019,  iLength);

      VarArrayRedim(UV_vC018,  iLength);
      VarArrayRedim(UV_vE010,  iLength);
      VarArrayRedim(UV_vS023,  iLength);
      VarArrayRedim(UV_vS029,  iLength);
      VarArrayRedim(UV_vS038,  iLength);
      VarArrayRedim(UV_vS040,  iLength);
      VarArrayRedim(UV_vS053,  iLength);
      VarArrayRedim(UV_vS054,  iLength);
      VarArrayRedim(UV_vSE38,  iLength);
      VarArrayRedim(UV_vT015,  iLength);

      VarArrayRedim(UV_vY005,  iLength);
      VarArrayRedim(UV_vY008,  iLength);

      VarArrayRedim(UV_vDRUC,  iLength);
      VarArrayRedim(UV_vC054,  iLength);
      VarArrayRedim(UV_vS096,  iLength);
      VarArrayRedim(UV_vS097,  iLength);

      VarArrayRedim(UV_vT051,  iLength);
      VarArrayRedim(UV_vT052,  iLength);
      VarArrayRedim(UV_vT053,  iLength);
      VarArrayRedim(UV_vT054,  iLength);

      VarArrayRedim(UV_vT055,  iLength);

      VarArrayRedim(UV_vU015,  iLength);
      VarArrayRedim(UV_vU016,  iLength);

      VarArrayRedim(UV_vT056,  iLength);
      VarArrayRedim(UV_vT057,  iLength);

      VarArrayRedim(UV_vH046,  iLength);
      VarArrayRedim(UV_vS100,  iLength);
      VarArrayRedim(UV_vT030,  iLength);
      VarArrayRedim(UV_vT059,  iLength);
      VarArrayRedim(UV_vS103,  iLength);
      VarArrayRedim(UV_vS105,  iLength);
      VarArrayRedim(UV_vS106,  iLength);
      VarArrayRedim(UV_vS107,  iLength);
      VarArrayRedim(UV_vS108,  iLength);
      VarArrayRedim(UV_vC044,  iLength);
      VarArrayRedim(UV_vC016,  iLength);
      VarArrayRedim(UV_vS109,  iLength);
      VarArrayRedim(UV_vS110,  iLength);

      VarArrayRedim(UV_vDesc_dc, iLength);
      VarArrayRedim(UV_vSampNo, iLength);
   end;
end;

function TfrmLD2Q04.UF_Condition : Boolean;
begin
   Result := True;

   // 조회조건중 필수항목이 입력되었는지 Check
   if edtBDate.Text = '' then
   begin
      GF_MsgBox('Warning', 'CONDITION');
      Result := False;
   end;
end;

procedure TfrmLD2Q04.FormCreate(Sender: TObject);
begin
   inherited;
   UP_VarMemSet(0);
   // 지사가 전체일 경우 지사를 Combo에 보여줌
   GP_ComboJisa(cmbjisa);

   RadioGroup1.ItemIndex:=2;
   // Default로 본사(15)를 선택
   GP_ComboDisplay(cmbjisa, copy(GV_sUserId,1,2), 2);
end;

procedure TfrmLD2Q04.grdMasterCellLoaded(Sender: TObject; DataCol,
  DataRow: Integer; var Value: Variant);
begin
   inherited;

   // 자룔를 화면에 조회
   case DataCol of
      1 : Value := UV_vNo[DataRow-1];
      2 : Value := UV_vJisa[DataRow-1];
      3 : Value := UV_vBUN[DataRow-1];
      4 : Value := UV_vName[DataRow-1];
      5 : Value := UV_vJumin[DataRow-1];

      6 : Value := UV_vE021[DataRow-1];
      7 : Value := UV_vS055[DataRow-1];
      8 : Value := UV_vS066[DataRow-1];
      9 : Value := UV_vU034[DataRow-1];
     10 : Value := UV_vE016[DataRow-1];
     11 : Value := UV_vC081[DataRow-1];
     12 : Value := UV_vT038[DataRow-1];
     13 : Value := UV_vY009[DataRow-1];
     14 : Value := UV_vE019[DataRow-1];
     15 : Value := UV_vSE16[DataRow-1];
     16 : Value := UV_vC038[DataRow-1];
     17 : Value := UV_vS093[DataRow-1];
     18 : Value := UV_vS100[DataRow-1];

     19 : Value := UV_vS039[DataRow-1];
     20 : Value := UV_vH038[DataRow-1];
     21 : Value := UV_vH039[DataRow-1];
     22 : Value := UV_vU049[DataRow-1];
     23 : Value := UV_vC075[DataRow-1];
     24 : Value := UV_vH031[DataRow-1];
     25 : Value := UV_vC076[DataRow-1];
     26 : Value := UV_vE050[DataRow-1];
     27 : Value := UV_vU039[DataRow-1];
     28 : Value := UV_vU040[DataRow-1];
     29 : Value := UV_vU041[DataRow-1];
     30 : Value := UV_vE051[DataRow-1];
     31 : Value := UV_vE052[DataRow-1];
     32 : Value := UV_vE053[DataRow-1];
     33 : Value := UV_vE054[DataRow-1];
          
     34 : Value := UV_vE055[DataRow-1];
     35 : Value := UV_vE056[DataRow-1];
     36 : Value := UV_vE057[DataRow-1];
     37 : Value := UV_vE058[DataRow-1];
     38 : Value := UV_vT005[DataRow-1];
     39 : Value := UV_vS022[DataRow-1];
     40 : Value := UV_vE049[DataRow-1];
     41 : Value := UV_vS086[DataRow-1];
     42 : Value := UV_vS087[DataRow-1];
     43 : Value := UV_vS088[DataRow-1];
     44 : Value := UV_vS089[DataRow-1];
     45 : Value := UV_vC036[DataRow-1];
     46 : Value := UV_vC065[DataRow-1];
     47 : Value := UV_vC072[DataRow-1];
     48 : Value := UV_vC079[DataRow-1];
     49 : Value := UV_vS059[DataRow-1];
     50 : Value := UV_vS060[DataRow-1];
     51 : Value := UV_vS061[DataRow-1];
     52 : Value := UV_vS062[DataRow-1];
     53 : Value := UV_vS063[DataRow-1];
     54 : Value := UV_vS070[DataRow-1];
     55 : Value := UV_vS081[DataRow-1];
     56 : Value := UV_vS098[DataRow-1];
     57 : Value := UV_vS030[DataRow-1];
     58 : Value := UV_vS031[DataRow-1];
     59 : Value := UV_vS032[DataRow-1];
     60 : Value := UV_vT018[DataRow-1];
     61 : Value := UV_vE013[DataRow-1];
     62 : Value := UV_vT021[DataRow-1];
     63 : Value := UV_vT022[DataRow-1];
     64 : Value := UV_vT023[DataRow-1];
     65 : Value := UV_vT024[DataRow-1];
     66 : Value := UV_vS094[DataRow-1];
     67 : Value := UV_vE047[DataRow-1];
     68 : Value := UV_vS076[DataRow-1];
     69 : Value := UV_vS077[DataRow-1];
     70 : Value := UV_vS078[DataRow-1];
     71 : Value := UV_vE012[DataRow-1];
     72 : Value := UV_vS085[DataRow-1];
     73 : Value := UV_vSE26[DataRow-1];
     74 : Value := UV_vSE27[DataRow-1];
     75 : Value := UV_vSE28[DataRow-1];
     76 : Value := UV_vSE29[DataRow-1];
     77 : Value := UV_vS095[DataRow-1];
     78 : Value := UV_vT026[DataRow-1];
     79 : Value := UV_vT027[DataRow-1];
     80 : Value := UV_vT028[DataRow-1];

     81 : Value := UV_vT032[DataRow-1];
     82 : Value := UV_vT033[DataRow-1];
     83 : Value := UV_vT035[DataRow-1];
     84 : Value := UV_vT036[DataRow-1];
     85 : Value := UV_vH027[DataRow-1];
     86 : Value := UV_vH028[DataRow-1];
     87 : Value := UV_vE014[DataRow-1];
     88 : Value := UV_vE059[DataRow-1];
     89 : Value := UV_vE060[DataRow-1];
     90 : Value := UV_vE061[DataRow-1];
     91 : Value := UV_vE062[DataRow-1];
     92 : Value := UV_vE063[DataRow-1];
     93 : Value := UV_vE064[DataRow-1];
     94 : Value := UV_vE065[DataRow-1];
     95 : Value := UV_vT044[DataRow-1];
     96 : Value := UV_vT045[DataRow-1];
     97 : Value := UV_vT046[DataRow-1];
     98 : Value := UV_vT047[DataRow-1];
     99 : Value := UV_vT048[DataRow-1];
     100: Value := UV_vE066[DataRow-1];
     101: Value := UV_vE067[DataRow-1];
     102: Value := UV_vT059[DataRow-1];
     103: Value := UV_vU048[DataRow-1];
     104: Value := UV_vS092[DataRow-1];
     105: Value := UV_vT050[DataRow-1];
     106: Value := UV_vC053[DataRow-1];
     107: Value := UV_vC055[DataRow-1];
     108: Value := UV_vT039[DataRow-1];
     109: Value := UV_vU019[DataRow-1];
     110: Value := UV_vC018[DataRow-1];
     111: Value := UV_vE010[DataRow-1];
     112: Value := UV_vS023[DataRow-1];
     113: Value := UV_vS029[DataRow-1];
     114: Value := UV_vS038[DataRow-1];
     115: Value := UV_vS040[DataRow-1];
     116: Value := UV_vS053[DataRow-1];
     117: Value := UV_vS054[DataRow-1];
     118: Value := UV_vSE38[DataRow-1];
     119: Value := UV_vT015[DataRow-1];
     120: Value := UV_vY005[DataRow-1];
     121: Value := UV_vY008[DataRow-1];
     122: Value := UV_vDRUC[DataRow-1];
     123: Value := UV_vC054[DataRow-1];
     124: Value := UV_vS096[DataRow-1];
     125: Value := UV_vS097[DataRow-1];
     126: Value := UV_vT051[DataRow-1];
     127: Value := UV_vT052[DataRow-1];
     128: Value := UV_vT053[DataRow-1];
     129: Value := UV_vT054[DataRow-1];
     130: Value := UV_vT055[DataRow-1];
     131: Value := UV_vU015[DataRow-1];
     132: Value := UV_vU016[DataRow-1];

     133: Value := UV_vT056[DataRow-1];
     134: Value := UV_vT057[DataRow-1];

     135: Value := UV_vH046[DataRow-1];
     136: Value := UV_vT030[DataRow-1];
     137: Value := UV_vS103[DataRow-1];
     138: Value := UV_vC016[DataRow-1];
     139: Value := UV_vS105[DataRow-1]; //2019.01.17추가 ▼
     140: Value := UV_vS106[DataRow-1];
     141: Value := UV_vS107[DataRow-1];
     142: Value := UV_vS108[DataRow-1];
     143: Value := UV_vC044[DataRow-1];
     144: Value := UV_vS109[DataRow-1];
     145: Value := UV_vS110[DataRow-1];

     146: Value := UV_vDesc_dc[DataRow-1];
     147: Value := UV_vSampNo[DataRow-1];


   end;
end;

procedure TfrmLD2Q04.btnQueryClick(Sender: TObject);
var index, I, iRet, iTemp,
    Sum_vE021, Sum_vS055, Sum_vS066, Sum_vU034,
    Sum_vE016, //Sum_vT012,
    Sum_vC081, Sum_vT038,
    //Sum_vC070,
    Sum_vE019, Sum_vSE16, Sum_vC038, Sum_vS093,
    Sum_vS039, Sum_vH038, Sum_vH039, Sum_vU049, Sum_vY009, Sum_vC075,
    Sum_vH031, Sum_vC076, Sum_vE050, Sum_vU039, Sum_vU040, Sum_vU041,
    Sum_vE051, Sum_vE052, Sum_vE053, Sum_vE054, Sum_vE055, Sum_vE056, Sum_vE057, Sum_vE058,
    Sum_vT005, Sum_vS022, Sum_vE049, //Sum_vS019,
    Sum_vS086, Sum_vS087, Sum_vS100,
    Sum_vS088, Sum_vS089, Sum_vC036,
    Sum_vC065, Sum_vC072, Sum_vC079, Sum_vS059, Sum_vS060, Sum_vS061, Sum_vS062, Sum_vS063, Sum_vS070, Sum_vS081, Sum_vS098,
    Sum_vS030, Sum_vS031, Sum_vS032, Sum_vT018, Sum_vE013, Sum_vT021, Sum_vT022, Sum_vT023, Sum_vT024, Sum_vS094, Sum_vE047,
    Sum_vS076, Sum_vS077, Sum_vS078, Sum_vE012, Sum_vS085, Sum_vSE26, Sum_vSE27, Sum_vSE28, Sum_vSE29, Sum_vS095,
    Sum_vT026, Sum_vT027, Sum_vT028, Sum_vT032, Sum_vT033, Sum_vT035, Sum_vT036, Sum_vH027, Sum_vH028, Sum_vE014,
    Sum_vE059, Sum_vE060, Sum_vE061, Sum_vE062, Sum_vE063, Sum_vE064, Sum_vE065, Sum_vT044, Sum_vT046, Sum_vT047,
    Sum_vT048, Sum_vT045, Sum_vE066, Sum_vE067, Sum_vT049, Sum_vU048, Sum_vS092, Sum_vT050, Sum_vC053, Sum_vC055,Sum_vT039,
    //Sum_vS018,
    Sum_vU019, Sum_vC018, Sum_vE010, Sum_vS023, Sum_vS038, Sum_vS040,Sum_vS053,
    Sum_vS054, Sum_vSE38, Sum_vT015, Sum_vS029, Sum_vY005, Sum_vY008, Sum_vDRUC, Sum_vC054, Sum_vS096, Sum_vS097,
    Sum_vT051, Sum_vT052, Sum_vT053, Sum_vT054, Sum_vT055, Sum_vU015, Sum_vU016, Sum_vT056, Sum_vT057, Sum_vH046, Sum_vT030,
    Sum_vT059, Sum_vS103, Sum_vS105, Sum_vS106, Sum_vS107, Sum_vS108, Sum_vC044, Sum_vC016, Sum_vS109, Sum_vS110 : Integer;

    sSelect, sWhere, sGroupBy, sOrderBy, sdate : String;
    sJangbi_List, sHul_List : String;
    vCod_chuga : Variant;
begin
   inherited;
   sSelect := ''; sWhere := ''; sOrderBy := '';
   Index := 0;

   Sum_vE021 := 0; Sum_vS055 := 0; Sum_vS066 := 0;
   Sum_vU034 := 0; 
   Sum_vE016 := 0; //Sum_vT012 := 0;
   Sum_vC081 := 0;
   Sum_vT038 := 0;
   //Sum_vC070 := 0;
   Sum_vE019 := 0; Sum_vSE16 := 0;
   Sum_vC038 := 0; Sum_vS093 := 0;
   Sum_vS039 := 0;
   Sum_vH038 := 0; Sum_vH039 := 0; Sum_vU049:= 0; 
   Sum_vY009 := 0; Sum_vC075 := 0; Sum_vH031 := 0; Sum_vC076 := 0;
   Sum_vE050 := 0; Sum_vU039 := 0; Sum_vU040 := 0; Sum_vU041 := 0;
   Sum_vE051 := 0; Sum_vE052 := 0; Sum_vE053 := 0; Sum_vE054 := 0;
   Sum_vE055 := 0; Sum_vE056 := 0; Sum_vE057 := 0; Sum_vE058 := 0;
   Sum_vT005 := 0; Sum_vS022 := 0; Sum_vE049 := 0; Sum_vS100 := 0;
   //Sum_vS019 := 0;
   Sum_vS086 := 0; Sum_vS087 := 0;
   Sum_vS088 := 0; Sum_vS089 := 0; Sum_vC036 := 0;

   Sum_vC065 := 0; Sum_vC072 := 0; Sum_vC079 := 0; Sum_vS059 := 0; Sum_vS060 := 0; Sum_vS061 := 0; Sum_vS062 := 0; Sum_vS063 := 0; Sum_vS070 := 0;
   Sum_vS081 := 0; Sum_vS098 := 0; Sum_vS030 := 0; Sum_vS031 := 0; Sum_vS032 := 0; Sum_vT018 := 0; Sum_vE013 := 0; Sum_vT021 := 0; Sum_vT022 := 0;
   Sum_vT023 := 0; Sum_vT024 := 0; Sum_vS094 := 0; Sum_vE047 := 0; Sum_vS076 := 0; Sum_vS077 := 0;
   Sum_vS078 := 0; Sum_vE012 := 0; Sum_vS085 := 0; Sum_vSE26 := 0; Sum_vSE27 := 0; Sum_vSE28 := 0; Sum_vSE29 := 0; Sum_vS095 := 0; Sum_vT026 := 0;
   Sum_vT027 := 0; Sum_vT028 := 0; Sum_vT032 := 0; Sum_vT033 := 0; Sum_vT035 := 0; Sum_vT036 := 0; Sum_vH027 := 0; Sum_vH028 := 0; Sum_vE014 := 0;
   Sum_vE059 := 0; Sum_vE060 := 0; Sum_vE061 := 0; Sum_vE062 := 0; Sum_vE063 := 0; Sum_vE064 := 0; Sum_vE065 := 0; Sum_vT044 := 0; Sum_vT045 := 0;
   Sum_vT046 := 0; Sum_vT047 := 0; Sum_vT048 := 0; Sum_vE066 := 0; Sum_vE067 := 0; Sum_vT049 := 0; Sum_vU048 := 0; Sum_vS092 := 0; Sum_vT050 := 0;
   Sum_vC053 := 0; Sum_vC055 := 0; Sum_vT039 := 0; //Sum_vS018 := 0;
   Sum_vU019 := 0; Sum_vS029 := 0;
   Sum_vC018 := 0; Sum_vE010 := 0; Sum_vS023 := 0; Sum_vS038 := 0; Sum_vS040 := 0; Sum_vS053 := 0; Sum_vS054 := 0; Sum_vSE38 := 0; Sum_vT015 := 0;
   Sum_vY005 := 0; Sum_vY008 := 0; Sum_vDRUC := 0; Sum_vC054 := 0; Sum_vS096 := 0; Sum_vS097 := 0;
   Sum_vT051 := 0; Sum_vT052 := 0; Sum_vT053 := 0; Sum_vT054 := 0; Sum_vT055 := 0;
   Sum_vU015 := 0; Sum_vU016 := 0; Sum_vT056 := 0; Sum_vT057 := 0; Sum_vH046 := 0; Sum_vT030 := 0; Sum_vT059 := 0; Sum_vS103 := 0; Sum_vC016 := 0;

   // 조회조건 Check
   if not UF_Condition then exit;

   // Grid 초기화
   grdMaster.Rows := 0;
   UP_VarMemSet(0);
   with qryBunju do
   begin
      // SQL문 생성
      Close;
      sSelect := ' select desc_name, num_jumin, dat_gmgn, cod_dc, desc_dc, cod_jisa, gubn_nosin, gubn_adult, gubn_life, Gubn_bogun, Gubn_agab, Gubn_tkgm,        ' +
                 ' Gubn_nsyh, Gubn_adyh, Gubn_lfyh, Gubn_bgyh, Gubn_agyh, num_Bunju, cod_jangbi, cod_hul, cod_cancer, cod_chuga,  cod_prf, Tcod_chuga, num_samp  ' +
                 ' from                                                                                                                                          ' +
                 ' (                                                                                                                                             ' +
                 ' SELECT G.desc_name, G.num_jumin, G.dat_gmgn, G.cod_dc, D.desc_dc, G.cod_jisa, G.gubn_nosin, G.gubn_adult, G.gubn_life, G.Gubn_bogun, G.Gubn_agab, G.Gubn_tkgm, ' +
                 ' Gubn_nsyh, Gubn_adyh, Gubn_lfyh, Gubn_bgyh, Gubn_agyh, K.num_Bunju, G.cod_jangbi, G.cod_hul, G.cod_cancer, G.cod_chuga,  T.cod_prf, T.cod_chuga As Tcod_chuga, G.num_samp ' +
                 ' FROM bunju K with(nolock) left outer join Gumgin G with(nolock) ON K.cod_jisa = G.cod_jisa and K.num_id = G.num_id and K.dat_gmgn = G.dat_gmgn ' +
                 '                           left outer join Danche D with(nolock) ON G.cod_dc = D.cod_dc ' +
                 '                           left outer join Tkgum T with(nolock) ON K.cod_jisa = T.cod_jisa and G.num_jumin = T.num_jumin and K.dat_gmgn = T.dat_gmgn and G.gubn_tkgm = T.gubn_cha ';

      sWhere  := ' WHERE K.Cod_bjjs = ''' + Copy(cmbJisa.Text,1,2) + '''';
      sWhere  := sWhere + ' AND (K.Dat_Bunju  = ''' + edtBDate.Text + ''' )' ;//' AND (K.Dat_Bunju  = ''' + edtBDate.Text + ''' )' ;

      If BunjuNo1.Text <> '' Then
         sWhere := sWhere + ' And K.Num_Bunju >= ''' + BunjuNo1.Text + '''' +
                            ' And K.Num_Bunju <= ''' + BunjuNo2.Text + '''';
      if Trim(edtDc.Text) <> '' then
         sWhere := sWhere + '  AND G.cod_dc = ''' + edtDc.Text + '''';

      sWhere := sWhere +
                ' union                                                                                                                                                ' +
                '                                                                                                                                                      ' +
                ' SELECT G.desc_name, G.num_jumin, G.dat_gmgn, G.cod_dc, D.desc_dc, G.cod_jisa, G.gubn_nosin, G.gubn_adult, G.gubn_life, G.Gubn_bogun, G.Gubn_agab, G.Gubn_tkgm, ' +
                ' Gubn_nsyh, Gubn_adyh, Gubn_lfyh, Gubn_bgyh, Gubn_agyh, '''', G.cod_jangbi, G.cod_hul, G.cod_cancer, G.cod_chuga, '''', '''', G.num_samp ' +
                ' FROM Gumgin G with(nolock) left outer join Danche D with(nolock) ON G.cod_dc = D.cod_dc ';

      sdate := GF_Date_decrease(StrToInt(copy(edtBDate.Text,1,4)), StrToInt(copy(edtBDate.Text,5,2)), StrToInt(copy(edtBDate.Text,7,2)),0);

      sWhere := sWhere + '  Where G.dat_gmgn = ''' + sdate + ''' ';
      sWhere := sWhere + '  and (G.gubn_hulgum = ''1'' or G.gubn_hulgum = ''3'')' ;
      sWhere := sWhere + '  and G.cod_chuga = ''DRUC'' ) A ' ;

      sWhere := sWhere + ' group by desc_name, num_jumin, dat_gmgn, cod_dc, desc_dc, cod_jisa, gubn_nosin, gubn_adult, gubn_life, Gubn_bogun, Gubn_agab, Gubn_tkgm, ' +
                         ' Gubn_nsyh, Gubn_adyh, Gubn_lfyh, Gubn_bgyh, Gubn_agyh, num_Bunju, cod_jangbi, cod_hul, cod_cancer, cod_chuga,  cod_prf, Tcod_chuga, num_samp  ';

      case RadioGroup1.ItemIndex of
         0 : sOrderBy := ' ORDER BY Num_Bunju';
         1 : sOrderBy := ' ORDER BY cod_jisa, CAST(num_samp AS INT) ';
         2 : sOrderBy := ' ORDER BY CAST(num_samp AS INT), cod_jisa, num_Bunju, desc_name  ';
      end;

      SQL.Clear;
      SQL.Add(sSelect + sWhere + sOrderBy);
      Open;
      Gride.MaxValue := RecordCount;

      if qryBunju.RecordCount > 0 then
      begin
         GP_query_log(qryBunju, 'LD2Q04', 'Q', 'N');
         For I := 1 to RecordCount do
//         while not qryBunju.Eof do
         Begin
            Gride.Progress := I;
            sHul_List := UF_hangmokList;
            if (pos('E021',sHul_List) > 0) or (pos('S055',sHul_List) > 0) or (pos('S066',sHul_List) > 0) or
               (pos('U034',sHul_List) > 0) or (pos('E016',sHul_List) > 0) or //(pos('T012',sHul_List) > 0) or
               (pos('C081',sHul_List) > 0) or
               (pos('T038',sHul_List) > 0) or //(pos('C070',sHul_List) > 0) or
               (pos('E019',sHul_List) > 0) or (pos('SE16',sHul_List) > 0) or
               (pos('C038',sHul_List) > 0) or (pos('S093',sHul_List) > 0) or
               (pos('S039',sHul_List) > 0) or (pos('H038',sHul_List) > 0) or (pos('H039',sHul_List) > 0) or
               (pos('U049',sHul_List) > 0) or (pos('Y009',sHul_List) > 0) or (pos('C075',sHul_List) > 0) or (pos('H031',sHul_List) > 0) or
               (pos('C076',sHul_List) > 0) or (pos('E050',sHul_List) > 0) or (pos('U039',sHul_List) > 0) or (pos('U040',sHul_List) > 0) or
               (pos('U041',sHul_List) > 0) or (pos('E051',sHul_List) > 0) or (pos('E052',sHul_List) > 0) or (pos('E053',sHul_List) > 0) or
               (pos('E054',sHul_List) > 0) or (pos('E055',sHul_List) > 0) or (pos('E056',sHul_List) > 0) or (pos('E057',sHul_List) > 0) or
               (pos('E058',sHul_List) > 0) or (pos('T005',sHul_List) > 0) or (pos('S022',sHul_List) > 0) or (pos('E049',sHul_List) > 0) or
               //(pos('S019',sHul_List) > 0) or
               (pos('S086',sHul_List) > 0) or (pos('S087',sHul_List) > 0) or (pos('S088',sHul_List) > 0) or
               (pos('S089',sHul_List) > 0) or (pos('C036',sHul_List) > 0) or (pos('C065',sHul_List) > 0) or (pos('C072',sHul_List) > 0) or
               (pos('C079',sHul_List) > 0) or (pos('S059',sHul_List) > 0) or (pos('S060',sHul_List) > 0) or (pos('S061',sHul_List) > 0) or
               (pos('S062',sHul_List) > 0) or (pos('S063',sHul_List) > 0) or (pos('S070',sHul_List) > 0) or (pos('S081',sHul_List) > 0) or
               (pos('S098',sHul_List) > 0) or (pos('S030',sHul_List) > 0) or (pos('S031',sHul_List) > 0) or (pos('S032',sHul_List) > 0) or
               (pos('T018',sHul_List) > 0) or (pos('E013',sHul_List) > 0) or (pos('T021',sHul_List) > 0) or (pos('T022',sHul_List) > 0) or
               (pos('T023',sHul_List) > 0) or (pos('T024',sHul_List) > 0) or (pos('S094',sHul_List) > 0) or (pos('E047',sHul_List) > 0) or
               (pos('S076',sHul_List) > 0) or (pos('S077',sHul_List) > 0) or (pos('S078',sHul_List) > 0) or (pos('E012',sHul_List) > 0) or
               (pos('S085',sHul_List) > 0) or (pos('SE26',sHul_List) > 0) or (pos('SE27',sHul_List) > 0) or (pos('SE28',sHul_List) > 0) or
               (pos('SE29',sHul_List) > 0) or (pos('S095',sHul_List) > 0) or (pos('T026',sHul_List) > 0) or (pos('T027',sHul_List) > 0) or
               (pos('T028',sHul_List) > 0) or (pos('T032',sHul_List) > 0) or (pos('T033',sHul_List) > 0) or (pos('T035',sHul_List) > 0) or
               (pos('T036',sHul_List) > 0) or (pos('H027',sHul_List) > 0) or (pos('H028',sHul_List) > 0) or (pos('E014',sHul_List) > 0) or
               (pos('E059',sHul_List) > 0) or (pos('E060',sHul_List) > 0) or (pos('E061',sHul_List) > 0) or (pos('E062',sHul_List) > 0) or
               (pos('E063',sHul_List) > 0) or (pos('E064',sHul_List) > 0) or (pos('E065',sHul_List) > 0) or (pos('T044',sHul_List) > 0) or
               (pos('T045',sHul_List) > 0) or (pos('T046',sHul_List) > 0) or (pos('T047',sHul_List) > 0) or (pos('T048',sHul_List) > 0) or
               (pos('E066',sHul_List) > 0) or (pos('E067',sHul_List) > 0) or (pos('U048',sHul_List) > 0) or
               (pos('S092',sHul_List) > 0) or (pos('T050',sHul_List) > 0) or (pos('C053',sHul_List) > 0) or (pos('C055',sHul_List) > 0) or
               //(pos('S018',sHul_List) > 0) or
               (pos('U019',sHul_List) > 0) or
               (pos('T039',sHul_List) > 0) or (pos('C018',sHul_List) > 0) or (pos('E010',sHul_List) > 0) or
               (pos('S023',sHul_List) > 0) or (pos('S038',sHul_List) > 0) or (pos('S040',sHul_List) > 0) or (pos('S053',sHul_List) > 0) or
               (pos('S054',sHul_List) > 0) or (pos('SE38',sHul_List) > 0) or (pos('T015',sHul_List) > 0) or (pos('S029',sHul_List) > 0) or
               (pos('Y005',sHul_List) > 0) or (pos('Y008',sHul_List) > 0) or
               (pos('DRUC',sHul_List) > 0) or (pos('C054',sHul_List) > 0) or (pos('S096',sHul_List) > 0) or (pos('S097',sHul_List) > 0) or
               (pos('T051',sHul_List) > 0) or (pos('T052',sHul_List) > 0) or (pos('T053',sHul_List) > 0) or (pos('T054',sHul_List) > 0) or
               (pos('T055',sHul_List) > 0) or (pos('U015',sHul_List) > 0) or (pos('U016',sHul_List) > 0) or (pos('T056',sHul_List) > 0) or
               (pos('T057',sHul_List) > 0) or (pos('H046',sHul_List) > 0) or (pos('S100',sHul_List) > 0) or (pos('T030',sHul_List) > 0) or
               (pos('T059',sHul_List) > 0) or (pos('S103',sHul_List) > 0) or (pos('C016',sHul_List) > 0) or (pos('S105',sHul_List) > 0) or
               (pos('S106',sHul_List) > 0) or (pos('S107',sHul_List) > 0) or (pos('S108',sHul_List) > 0) or (pos('C044',sHul_List) > 0) Then
            begin
               UP_VarMemSet(Index+1);
               UV_vNo[Index]  := IntToStr(Index+1) + '/'+ qryBunju.FieldByName('dat_gmgn').AsString;
               UV_VBUN[Index] := qryBunju.FieldByName('Num_Bunju').AsString;
               UV_vName[Index] := qryBunju.FieldByName('desc_name').AsString;
               UV_vJumin[Index] := copy(qryBunju.FieldByName('num_jumin').AsString,1,7) ;
               UV_vJisa[Index] := qryBunju.FieldByName('cod_jisa').AsString;
               UV_vDesc_dc[Index] := qryBunju.FieldByName('desc_dc').AsString;
               UV_vSampNo[Index] := qryBunju.FieldByName('num_samp').AsString;

               if pos('E021', sHul_List) > 0 then
               begin
                  UV_vE021[Index] := '';
                  Sum_vE021 := Sum_vE021 + 1;
               end
               else                               UV_vE021[Index] := '*';          //Sum_vE021
               if pos('S055', sHul_List) > 0 then
               begin
                  UV_vS055[Index] := '';
                  Sum_vS055 := Sum_vS055 + 1;
               end
               else                               UV_vS055[Index] := '*';          //Sum_vS055
               if pos('S066', sHul_List) > 0 then
               begin
                  UV_vS066[Index] := '';
                  Sum_vS066 := Sum_vS066 + 1;
               end
               else                               UV_vS066[Index] := '*';          //Sum_vS066
               if pos('U034', sHul_List) > 0 then
               begin
                  UV_vU034[Index] := '';
                  Sum_vU034 := Sum_vU034 + 1;
               end
               else                               UV_vU034[Index] := '*';          //Sum_vU034
               if pos('E016', sHul_List) > 0 then
               begin
                  UV_vE016[Index] := '';
                  Sum_vE016 := Sum_vE016 + 1;
               end
               else                               UV_vE016[Index] := '*';          //Sum_vE016
               if pos('C081', sHul_List) > 0 then
               begin
                  UV_vC081[Index] := '';
                  Sum_vC081 := Sum_vC081 + 1;
               end
               else                               UV_vC081[Index] := '*';          //Sum_vC081
               if pos('T038', sHul_List) > 0 then
               begin
                  UV_vT038[Index] := '';
                  Sum_vT038 := Sum_vT038 + 1;
               end
               else                               UV_vT038[Index] := '*';          //Sum_vT038
               if pos('E019', sHul_List) > 0 then
               begin
                  UV_vE019[Index] := '';
                  Sum_vE019 := Sum_vE019 + 1;
               end
               else                               UV_vE019[Index] := '*';          //Sum_vE019
               if pos('SE16', sHul_List) > 0 then
               begin
                  UV_vSE16[Index] := '';
                  Sum_vSE16 := Sum_vSE16 + 1;
               end
               else                               UV_vSE16[Index] := '*';          //Sum_vSE16
               if pos('C038', sHul_List) > 0 then
               begin
                  UV_vC038[Index] := '';
                  Sum_vC038 := Sum_vC038 + 1;
               end
               else                               UV_vC038[Index] := '*';          //Sum_vC038
               if pos('S093', sHul_List) > 0 then
               begin
                  UV_vS093[Index] := '';
                  Sum_vS093 := Sum_vS093 + 1;
               end
               else                               UV_vS093[Index] := '*';          //Sum_vS093
              { if pos('C020', sHul_List) > 0 then
               begin
                  UV_vC020[Index] := '';
                  Sum_vC020 := Sum_vC020 + 1;
               end
               else                               UV_vC020[Index] := '*';          //Sum_vC020  }
               if pos('S039', sHul_List) > 0 then
               begin
                  UV_vS039[Index] := '';
                  Sum_vS039 := Sum_vS039 + 1;
               end
               else                               UV_vS039[Index] := '*';          //Sum_vS039
              if pos('H038', sHul_List) > 0 then
               begin
                  UV_vH038[Index] := '';
                  Sum_vH038 := Sum_vH038 + 1;
               end
               else                               UV_vH038[Index] := '*';          //Sum_vH038
              if pos('H039', sHul_List) > 0 then
               begin
                  UV_vH039[Index] := '';
                  Sum_vH039 := Sum_vH039 + 1;
               end
               else                               UV_vH039[Index] := '*';          //Sum_vH039
               if pos('U049', sHul_List) > 0 then
               begin
                  UV_vU049[Index] := '';
                  Sum_vU049 := Sum_vU049 + 1;
               end
               else                               UV_vU049[Index] := '*';          //Sum_vU049
               if pos('Y009', sHul_List) > 0 then
               begin
                  UV_vY009[Index] := '';
                  Sum_vY009 := Sum_vY009 + 1;
               end
               else                               UV_vY009[Index] := '*';          //Sum_vY009
               if pos('C075', sHul_List) > 0 then
               begin
                  UV_vC075[Index] := '';
                  Sum_vC075 := Sum_vC075 + 1;
               end
               else                               UV_vC075[Index] := '*';          //Sum_vC075
               if pos('H031', sHul_List) > 0 then
               begin
                  UV_vH031[Index] := '';
                  Sum_vH031 := Sum_vH031 + 1;
               end
               else                               UV_vH031[Index] := '*';          //Sum_vH031
               if pos('C076', sHul_List) > 0 then
               begin
                  UV_vC076[Index] := '';
                  Sum_vC076 := Sum_vC076 + 1;
               end
               else                               UV_vC076[Index] := '*';          //Sum_vC076
               if pos('E050', sHul_List) > 0 then
               begin
                  UV_vE050[Index] := '';
                  Sum_vE050 := Sum_vE050 + 1;
               end
               else                               UV_vE050[Index] := '*';          //Sum_vE050
               if pos('U039', sHul_List) > 0 then
               begin
                  UV_vU039[Index] := '';
                  Sum_vU039 := Sum_vU039 + 1;
               end
               else                               UV_vU039[Index] := '*';          //Sum_vU039
               if pos('U040', sHul_List) > 0 then
               begin
                  UV_vU040[Index] := '';
                  Sum_vU040 := Sum_vU040 + 1;
               end
               else                               UV_vU040[Index] := '*';          //Sum_vU040
               if pos('U041', sHul_List) > 0 then
               begin
                  UV_vU041[Index] := '';
                  Sum_vU041 := Sum_vU041 + 1;
               end
               else                               UV_vU041[Index] := '*';          //Sum_vU041
               if pos('E051', sHul_List) > 0 then
               begin
                  UV_vE051[Index] := '';
                  Sum_vE051 := Sum_vE051 + 1;
               end
               else                               UV_vE051[Index] := '*';          //Sum_vE051
               if pos('E052', sHul_List) > 0 then
               begin
                  UV_vE052[Index] := '';
                  Sum_vE052 := Sum_vE052 + 1;
               end
               else                               UV_vE052[Index] := '*';          //Sum_vE052
               if pos('E053', sHul_List) > 0 then
               begin
                  UV_vE053[Index] := '';
                  Sum_vE053 := Sum_vE053 + 1;
               end
               else                               UV_vE053[Index] := '*';          //Sum_vE053
               if pos('E054', sHul_List) > 0 then
               begin
                  UV_vE054[Index] := '';
                  Sum_vE054 := Sum_vE054 + 1;
               end
               else                               UV_vE054[Index] := '*';          //Sum_vE054
               if pos('E055', sHul_List) > 0 then
               begin
                  UV_vE055[Index] := '';
                  Sum_vE055 := Sum_vE055 + 1;
               end
               else                               UV_vE055[Index] := '*';          //Sum_vE055
               if pos('E056', sHul_List) > 0 then
               begin
                  UV_vE056[Index] := '';
                  Sum_vE056 := Sum_vE056 + 1;
               end
               else                               UV_vE056[Index] := '*';          //Sum_vE056
               if pos('E057', sHul_List) > 0 then
               begin
                  UV_vE057[Index] := '';
                  Sum_vE057 := Sum_vE057 + 1;
               end
               else                               UV_vE057[Index] := '*';          //Sum_vE057
               if pos('E058', sHul_List) > 0 then
               begin
                  UV_vE058[Index] := '';
                  Sum_vE058 := Sum_vE058 + 1;
               end
               else                               UV_vE058[Index] := '*';          //Sum_vE058
               if pos('T005', sHul_List) > 0 then
               begin
                  UV_vT005[Index] := '';
                  Sum_vT005 := Sum_vT005 + 1;
               end
               else                               UV_vT005[Index] := '*';          //Sum_vT005
               if pos('S022', sHul_List) > 0 then
               begin
                  UV_vS022[Index] := '';
                  Sum_vS022 := Sum_vS022 + 1;
               end
               else                               UV_vS022[Index] := '*';          //Sum_vS022
               if pos('E049', sHul_List) > 0 then
               begin
                  UV_vE049[Index] := '';
                  Sum_vE049 := Sum_vE049 + 1;
               end
               else                               UV_vE049[Index] := '*';          //Sum_vE049
               if pos('S086', sHul_List) > 0 then
               begin
                  UV_vS086[Index] := '';
                  Sum_vS086 := Sum_vS086 + 1;
               end
               else                               UV_vS086[Index] := '*';          //Sum_vS086
               if pos('S087', sHul_List) > 0 then
               begin
                  UV_vS087[Index] := '';
                  Sum_vS087 := Sum_vS087 + 1;
               end
               else                               UV_vS087[Index] := '*';          //Sum_vS087
               if pos('S088', sHul_List) > 0 then
               begin
                  UV_vS088[Index] := '';
                  Sum_vS088 := Sum_vS088 + 1;
               end
               else                               UV_vS088[Index] := '*';          //Sum_vS088
               if pos('S089', sHul_List) > 0 then
               begin
                  UV_vS089[Index] := '';
                  Sum_vS089 := Sum_vS089 + 1;
               end
               else                               UV_vS089[Index] := '*';          //Sum_vS089
               if pos('C036', sHul_List) > 0 then
               begin
                  UV_vC036[Index] := '';
                  Sum_vC036 := Sum_vC036 + 1;
               end
               else                               UV_vC036[Index] := '*';          //Sum_vC036

               if pos('C065', sHul_List) > 0 then
               begin
                  UV_vC065[Index] := '';
                  Sum_vC065 := Sum_vC065 + 1;
               end
               else                               UV_vC065[Index] := '*';          //Sum_vC065
               if pos('C072', sHul_List) > 0 then
               begin
                  UV_vC072[Index] := '';
                  Sum_vC072 := Sum_vC072 + 1;
               end
               else                               UV_vC072[Index] := '*';          //Sum_vC072
               if pos('C079', sHul_List) > 0 then
               begin
                  UV_vC079[Index] := '';
                  Sum_vC079 := Sum_vC079 + 1;
               end
               else                               UV_vC079[Index] := '*';          //Sum_vC079
               if pos('S059', sHul_List) > 0 then
               begin
                  UV_vS059[Index] := '';
                  Sum_vS059 := Sum_vS059 + 1;
               end
               else                               UV_vS059[Index] := '*';          //Sum_vS059
               if pos('S060', sHul_List) > 0 then
               begin
                  UV_vS060[Index] := '';
                  Sum_vS060 := Sum_vS060 + 1;
               end
               else                               UV_vS060[Index] := '*';          //Sum_vS060
               if pos('S061', sHul_List) > 0 then
               begin
                  UV_vS061[Index] := '';
                  Sum_vS061 := Sum_vS061 + 1;
               end
               else                               UV_vS061[Index] := '*';          //Sum_vS061

               if pos('S062', sHul_List) > 0 then
               begin
                  UV_vS062[Index] := '';
                  Sum_vS062 := Sum_vS062 + 1;
               end
               else                               UV_vS062[Index] := '*';          //Sum_vS062
               if pos('S063', sHul_List) > 0 then
               begin
                  UV_vS063[Index] := '';
                  Sum_vS063 := Sum_vS063 + 1;
               end
               else                               UV_vS063[Index] := '*';          //Sum_vS063
               if pos('S070', sHul_List) > 0 then
               begin
                  UV_vS070[Index] := '';
                  Sum_vS070 := Sum_vS070 + 1;
               end
               else                               UV_vS070[Index] := '*';          //Sum_vS070
               if pos('S081', sHul_List) > 0 then
               begin
                  UV_vS081[Index] := '';
                  Sum_vS081 := Sum_vS081 + 1;
               end
               else                               UV_vS081[Index] := '*';          //Sum_vS081
               if pos('S098', sHul_List) > 0 then
               begin
                  UV_vS098[Index] := '';
                  Sum_vS098 := Sum_vS098 + 1;
               end
               else                               UV_vS098[Index] := '*';          //Sum_vS098
               if pos('S030', sHul_List) > 0 then
               begin
                  UV_vS030[Index] := '';
                  Sum_vS030 := Sum_vS030 + 1;
               end
               else                               UV_vS030[Index] := '*';          //Sum_vS030
               if pos('S031', sHul_List) > 0 then
               begin
                  UV_vS031[Index] := '';
                  Sum_vS031 := Sum_vS031 + 1;
               end
               else                               UV_vS031[Index] := '*';          //Sum_vS031
               if pos('S032', sHul_List) > 0 then
               begin
                  UV_vS032[Index] := '';
                  Sum_vS032 := Sum_vS032 + 1;
               end
               else                               UV_vS032[Index] := '*';          //Sum_vS032
               if pos('T018', sHul_List) > 0 then
               begin
                  UV_vT018[Index] := '';
                  Sum_vT018 := Sum_vT018 + 1;
               end
               else                               UV_vT018[Index] := '*';          //Sum_vT018
               if pos('E013', sHul_List) > 0 then
               begin
                  UV_vE013[Index] := '';
                  Sum_vE013 := Sum_vE013 + 1;
               end
               else                               UV_vE013[Index] := '*';          //Sum_vE013
               if pos('T021', sHul_List) > 0 then
               begin
                  UV_vT021[Index] := '';
                  Sum_vT021 := Sum_vT021 + 1;
               end
               else                               UV_vT021[Index] := '*';          //Sum_vT021
               if pos('T022', sHul_List) > 0 then
               begin
                  UV_vT022[Index] := '';
                  Sum_vT022 := Sum_vT022 + 1;
               end
               else                               UV_vT022[Index] := '*';          //Sum_vT022
               if pos('T023', sHul_List) > 0 then
               begin
                  UV_vT023[Index] := '';
                  Sum_vT023 := Sum_vT023 + 1;
               end
               else                               UV_vT023[Index] := '*';          //Sum_vT023
               if pos('T024', sHul_List) > 0 then
               begin
                  UV_vT024[Index] := '';
                  Sum_vT024 := Sum_vT024 + 1;
               end
               else                               UV_vT024[Index] := '*';          //Sum_vT024
               if pos('S094', sHul_List) > 0 then
               begin
                  UV_vS094[Index] := '';
                  Sum_vS094 := Sum_vS094 + 1;
               end
               else                               UV_vS094[Index] := '*';          //Sum_vS094
               if pos('E047', sHul_List) > 0 then
               begin
                  UV_vE047[Index] := '';
                  Sum_vE047 := Sum_vE047 + 1;
               end
               else                               UV_vE047[Index] := '*';          //Sum_vE047
               if pos('S076', sHul_List) > 0 then
               begin
                  UV_vS076[Index] := '';
                  Sum_vS076 := Sum_vS076 + 1;
               end
               else                               UV_vS076[Index] := '*';          //Sum_vS076
               if pos('S077', sHul_List) > 0 then
               begin
                  UV_vS077[Index] := '';
                  Sum_vS077 := Sum_vS077 + 1;
               end
               else                               UV_vS077[Index] := '*';          //Sum_vS077
               if pos('S078', sHul_List) > 0 then
               begin
                  UV_vS078[Index] := '';
                  Sum_vS078 := Sum_vS078 + 1;
               end
               else                               UV_vS078[Index] := '*';          //Sum_vS078
               if pos('E012', sHul_List) > 0 then
               begin
                  UV_vE012[Index] := '';
                  Sum_vE012 := Sum_vE012 + 1;
               end
               else                               UV_vE012[Index] := '*';          //Sum_vE012

               if pos('S085', sHul_List) > 0 then
               begin
                  UV_vS085[Index] := '';
                  Sum_vS085 := Sum_vS085 + 1;
               end
               else                               UV_vS085[Index] := '*';          //Sum_vS085
               if pos('SE26', sHul_List) > 0 then
               begin
                  UV_vSE26[Index] := '';
                  Sum_vSE26 := Sum_vSE26 + 1;
               end
               else                               UV_vSE26[Index] := '*';          //Sum_vSE26
               if pos('SE27', sHul_List) > 0 then
               begin
                  UV_vSE27[Index] := '';
                  Sum_vSE27 := Sum_vSE27 + 1;
               end
               else                               UV_vSE27[Index] := '*';          //Sum_vSE27
               if pos('SE28', sHul_List) > 0 then
               begin
                  UV_vSE28[Index] := '';
                  Sum_vSE28 := Sum_vSE28 + 1;
               end
               else                               UV_vSE28[Index] := '*';          //Sum_vSE28
               if pos('SE29', sHul_List) > 0 then
               begin
                  UV_vSE29[Index] := '';
                  Sum_vSE29 := Sum_vSE29 + 1;
               end
               else                               UV_vSE29[Index] := '*';          //Sum_vSE29
               if pos('S095', sHul_List) > 0 then
               begin
                  UV_vS095[Index] := '';
                  Sum_vS095 := Sum_vS095 + 1;
               end
               else                               UV_vS095[Index] := '*';          //Sum_vS095
               if pos('T026', sHul_List) > 0 then
               begin
                  UV_vT026[Index] := '';
                  Sum_vT026 := Sum_vT026 + 1;
               end
               else                               UV_vT026[Index] := '*';          //Sum_vT026
               if pos('T027', sHul_List) > 0 then
               begin
                  UV_vT027[Index] := '';
                  Sum_vT027 := Sum_vT027 + 1;
               end
               else                               UV_vT027[Index] := '*';          //Sum_vT027
               if pos('T028', sHul_List) > 0 then
               begin
                  UV_vT028[Index] := '';
                  Sum_vT028 := Sum_vT028 + 1;
               end
               else                               UV_vT028[Index] := '*';          //Sum_vT028
               if pos('T032', sHul_List) > 0 then
               begin
                  UV_vT032[Index] := '';
                  Sum_vT032 := Sum_vT032 + 1;
               end
               else                               UV_vT032[Index] := '*';          //Sum_vT032
               if pos('T033', sHul_List) > 0 then
               begin
                  UV_vT033[Index] := '';
                  Sum_vT033 := Sum_vT033 + 1;
               end
               else                               UV_vT033[Index] := '*';          //Sum_vT033
               if pos('T035', sHul_List) > 0 then
               begin
                  UV_vT035[Index] := '';
                  Sum_vT035 := Sum_vT035 + 1;
               end
               else                               UV_vT035[Index] := '*';          //Sum_vT035
               if pos('T036', sHul_List) > 0 then
               begin
                  UV_vT036[Index] := '';
                  Sum_vT036 := Sum_vT036 + 1;
               end
               else                               UV_vT036[Index] := '*';          //Sum_vT036
               if pos('H027', sHul_List) > 0 then
               begin
                  UV_vH027[Index] := '';
                  Sum_vH027 := Sum_vH027 + 1;
               end
               else                               UV_vH027[Index] := '*';          //Sum_vH027
               if pos('H028', sHul_List) > 0 then
               begin
                  UV_vH028[Index] := '';
                  Sum_vH028 := Sum_vH028 + 1;
               end
               else                               UV_vH028[Index] := '*';          //Sum_vH028
               if pos('E014', sHul_List) > 0 then
               begin
                  UV_vE014[Index] := '';
                  Sum_vE014 := Sum_vE014 + 1;
               end
               else                               UV_vE014[Index] := '*';          //Sum_vE014
               if pos('E059', sHul_List) > 0 then
               begin
                  UV_vE059[Index] := '';
                  Sum_vE059 := Sum_vE059 + 1;
               end
               else                               UV_vE059[Index] := '*';          //Sum_vE059
               if pos('E060', sHul_List) > 0 then
               begin
                  UV_vE060[Index] := '';
                  Sum_vE060 := Sum_vE060 + 1;
               end
               else                               UV_vE060[Index] := '*';          //Sum_vE060
               if pos('E061', sHul_List) > 0 then
               begin
                  UV_vE061[Index] := '';
                  Sum_vE061 := Sum_vE061 + 1;
               end
               else                               UV_vE061[Index] := '*';          //Sum_vE061
               if pos('E062', sHul_List) > 0 then
               begin
                  UV_vE062[Index] := '';
                  Sum_vE062 := Sum_vE062 + 1;
               end
               else                               UV_vE062[Index] := '*';          //Sum_vE062
               if pos('E063', sHul_List) > 0 then
               begin
                  UV_vE063[Index] := '';
                  Sum_vE063 := Sum_vE063 + 1;
               end
               else                               UV_vE063[Index] := '*';          //Sum_vE063
               if pos('E064', sHul_List) > 0 then
               begin
                  UV_vE064[Index] := '';
                  Sum_vE064 := Sum_vE064 + 1;
               end
               else                               UV_vE064[Index] := '*';          //Sum_vE064
               if pos('E065', sHul_List) > 0 then
               begin
                  UV_vE065[Index] := '';
                  Sum_vE065 := Sum_vE065 + 1;
               end
               else                               UV_vE065[Index] := '*';          //Sum_vE065

               if pos('T044', sHul_List) > 0 then
               begin
                  UV_vT044[Index] := '';
                  Sum_vT044 := Sum_vT044 + 1;
               end
               else                               UV_vT044[Index] := '*';          //Sum_vT044
               if pos('T045', sHul_List) > 0 then
               begin
                  UV_vT045[Index] := '';
                  Sum_vT045 := Sum_vT045 + 1;
               end
               else                               UV_vT045[Index] := '*';          //Sum_vT045
               if pos('T046', sHul_List) > 0 then
               begin
                  UV_vT046[Index] := '';
                  Sum_vT046 := Sum_vT046 + 1;
               end
               else                               UV_vT046[Index] := '*';          //Sum_vT046
               if pos('T047', sHul_List) > 0 then
               begin
                  UV_vT047[Index] := '';
                  Sum_vT047 := Sum_vT047 + 1;
               end
               else                               UV_vT047[Index] := '*';          //Sum_vT047
              if pos('T048', sHul_List) > 0 then
               begin
                  UV_vT048[Index] := '';
                  Sum_vT048 := Sum_vT048 + 1;
               end
               else                               UV_vT048[Index] := '*';          //Sum_vT048
               if pos('E066', sHul_List) > 0 then
               begin
                  UV_vE066[Index] := '';
                  Sum_vE066 := Sum_vE066 + 1;
               end
               else                               UV_vE066[Index] := '*';          //Sum_vE066
               if pos('E067', sHul_List) > 0 then
               begin
                  UV_vE067[Index] := '';
                  Sum_vE067 := Sum_vE067 + 1;
               end
               else                               UV_vE067[Index] := '*';          //Sum_vE067
               if pos('U048', sHul_List) > 0 then
               begin
                  UV_vU048[Index] := '';
                  Sum_vU048 := Sum_vU048 + 1;
               end
               else                               UV_vU048[Index] := '*';          //Sum_vU048
               if pos('S092', sHul_List) > 0 then
               begin
                  UV_vS092[Index] := '';
                  Sum_vS092 := Sum_vS092 + 1;
               end
               else                               UV_vS092[Index] := '*';          //Sum_vS092
               if pos('T050', sHul_List) > 0 then
               begin
                  UV_vT050[Index] := '';
                  Sum_vT050 := Sum_vT050 + 1;
               end
               else                               UV_vT050[Index] := '*';          //Sum_vT050
               if pos('C053', sHul_List) > 0 then
               begin
                  UV_vC053[Index] := '';
                  Sum_vC053 := Sum_vC053 + 1;
               end
               else                               UV_vC053[Index] := '*';          //Sum_vC053
               if pos('C055', sHul_List) > 0 then
               begin
                  UV_vC055[Index] := '';
                  Sum_vC055 := Sum_vC055 + 1;
               end
               else                               UV_vC055[Index] := '*';          //Sum_vC055
               if pos('T039', sHul_List) > 0 then
               begin
                  UV_vT039[Index] := '';
                  Sum_vT039 := Sum_vT039 + 1;
               end
               else                               UV_vT039[Index] := '*';          //Sum_vT039
               if pos('U019', sHul_List) > 0 then
               begin
                  UV_vU019[Index] := '';
                  Sum_vU019 := Sum_vU019 + 1;
               end
               else                               UV_vU019[Index] := '*';          //Sum_vU019

               if pos('C018', sHul_List) > 0 then
               begin
                  UV_vC018[Index] := '';
                  Sum_vC018 := Sum_vC018 + 1;
               end
               else                               UV_vC018[Index] := '*';          //Sum_vC018

               if pos('E010', sHul_List) > 0 then
               begin
                  UV_vE010[Index] := '';
                  Sum_vE010 := Sum_vE010 + 1;
               end
               else                               UV_vE010[Index] := '*';          //Sum_vE010

               if pos('S023', sHul_List) > 0 then
               begin
                  UV_vS023[Index] := '';
                  Sum_vS023 := Sum_vS023 + 1;
               end
               else                               UV_vS023[Index] := '*';          //Sum_vSE23

               if pos('S038', sHul_List) > 0 then
               begin
                  UV_vS038[Index] := '';
                  Sum_vS038 := Sum_vS038 + 1;
               end
               else                               UV_vS038[Index] := '*';          //Sum_vS038

               if pos('S040', sHul_List) > 0 then
               begin
                  UV_vS040[Index] := '';
                  Sum_vS040 := Sum_vS040 + 1;
               end
               else                               UV_vS040[Index] := '*';          //Sum_vS040
               if pos('S053', sHul_List) > 0 then
               begin
                  UV_vS053[Index] := '';
                  Sum_vS053 := Sum_vS053 + 1;
               end
               else                               UV_vS053[Index] := '*';          //Sum_vS053
               if pos('S054', sHul_List) > 0 then
               begin
                  UV_vS054[Index] := '';
                  Sum_vS054 := Sum_vS054 + 1;
               end
               else                               UV_vS054[Index] := '*';          //Sum_vS054
               if pos('SE38', sHul_List) > 0 then
               begin
                  UV_vSE38[Index] := '';
                  Sum_vSE38 := Sum_vSE38 + 1;
               end
               else                               UV_vSE38[Index] := '*';          //Sum_vSE38

               if pos('T015', sHul_List) > 0 then
               begin
                  UV_vT015[Index] := '';
                  Sum_vT015 := Sum_vT015 + 1;
               end
               else                               UV_vT015[Index] := '*';          //Sum_vT015

               if pos('S029', sHul_List) > 0 then
               begin
                  UV_vS029[Index] := '';
                  Sum_vS029 := Sum_vS029 + 1;
               end
               else                               UV_vS029[Index] := '*';          //Sum_vS029

               if pos('Y005', sHul_List) > 0 then
               begin
                  UV_vY005[Index] := '';
                  Sum_vY005 := Sum_vY005 + 1;
               end
               else                               UV_vY005[Index] := '*';          //Sum_vY005

               if pos('Y008', sHul_List) > 0 then
               begin
                  UV_vY008[Index] := '';
                  Sum_vY008 := Sum_vY008 + 1;
               end
               else                               UV_vY008[Index] := '*';          //Sum_vY008

               if pos('DRUC', sHul_List) > 0 then
               begin
                  UV_vDRUC[Index] := '';
                  Sum_vDRUC := Sum_vDRUC + 1;
               end
               else                               UV_vDRUC[Index] := '*';          //Sum_vDRUC

               if pos('C054', sHul_List) > 0 then
               begin
                  UV_vC054[Index] := '';
                  Sum_vC054 := Sum_vC054 + 1;
               end
               else                               UV_vC054[Index] := '*';          //Sum_vC054

               if pos('S096', sHul_List) > 0 then
               begin
                  UV_vS096[Index] := '';
                  Sum_vS096 := Sum_vS096 + 1;
               end
               else                               UV_vS096[Index] := '*';          //Sum_vS096

               if pos('S097', sHul_List) > 0 then
               begin
                  UV_vS097[Index] := '';
                  Sum_vS097 := Sum_vS097 + 1;
               end
               else                               UV_vS097[Index] := '*';          //Sum_vS097

               if pos('T051', sHul_List) > 0 then
               begin
                  UV_vT051[Index] := '';
                  Sum_vT051 := Sum_vT051 + 1;
               end
               else                               UV_vT051[Index] := '*';          //Sum_vT051
               if pos('T052', sHul_List) > 0 then
               begin
                  UV_vT052[Index] := '';
                  Sum_vT052 := Sum_vT052 + 1;
               end
               else                               UV_vT052[Index] := '*';          //Sum_vT052
               if pos('T053', sHul_List) > 0 then
               begin
                  UV_vT053[Index] := '';
                  Sum_vT053 := Sum_vT053 + 1;
               end
               else                               UV_vT053[Index] := '*';          //Sum_vT053
               if pos('T054', sHul_List) > 0 then
               begin
                  UV_vT054[Index] := '';
                  Sum_vT054 := Sum_vT054 + 1;
               end
               else                               UV_vT054[Index] := '*';          //Sum_vT054
               if pos('T055', sHul_List) > 0 then
               begin
                  UV_vT055[Index] := '';
                  Sum_vT055 := Sum_vT055 + 1;
               end
               else                               UV_vT055[Index] := '*';          //Sum_vT055
               if (pos('U015', sHul_List) > 0) then
               begin
                  UV_vU015[Index] := '';
                  Sum_vU015 := Sum_vU015 + 1;
               end
               else                               UV_vU015[Index] := '*';          //Sum_vU015
               if (pos('U016', sHul_List) > 0) then
               begin
                  UV_vU016[Index] := '';
                  Sum_vU016 := Sum_vU016 + 1;
               end
               else                               UV_vU016[Index] := '*';          //Sum_vU016
               if (pos('T056', sHul_List) > 0) then
               begin
                  UV_vT056[Index] := '';
                  Sum_vT056 := Sum_vT056 + 1;
               end
               else                               UV_vT056[Index] := '*';          //Sum_vT056
               if (pos('T057', sHul_List) > 0) then
               begin
                  UV_vT057[Index] := '';
                  Sum_vT057 := Sum_vT057 + 1;
               end
               else                               UV_vT057[Index] := '*';          //Sum_vT057
               if (pos('H046', sHul_List) > 0) then
               begin
                  UV_vH046[Index] := '';
                  Sum_vH046 := Sum_vH046 + 1;
               end
               else                               UV_vH046[Index] := '*';          //Sum_vH046
               if (pos('S100', sHul_List) > 0) then
               begin
                  UV_vS100[Index] := '';
                  Sum_vS100 := Sum_vS100 + 1;
               end
               else                               UV_vS100[Index] := '*';          //Sum_vS100
               if (pos('T030', sHul_List) > 0) then
               begin
                  UV_vT030[Index] := '';
                  Sum_vT030 := Sum_vT030 + 1;
               end
               else                               UV_vT030[Index] := '*';          //Sum_vT030
               if (pos('T059', sHul_List) > 0) then
               begin
                  UV_vT059[Index] := '';
                  Sum_vT059 := Sum_vT059 + 1;
               end
               else                               UV_vT059[Index] := '*';          //Sum_vT059
               if (pos('S103', sHul_List) > 0) then
               begin
                  UV_vS103[Index] := '';
                  Sum_vS103 := Sum_vS103 + 1;
               end
               else                               UV_vS103[Index] := '*';          //Sum_vS103

               if (pos('S105', sHul_List) > 0) then
               begin
                  UV_vS105[Index] := '';
                  Sum_vS105 := Sum_vS105 + 1;
               end
               else                               UV_vS105[Index] := '*';          //Sum_vS105
               if (pos('S106', sHul_List) > 0) then
               begin
                  UV_vS106[Index] := '';
                  Sum_vS106 := Sum_vS106 + 1;
               end
               else                               UV_vS106[Index] := '*';          //Sum_vS106
               if (pos('S107', sHul_List) > 0) then
               begin
                  UV_vS107[Index] := '';
                  Sum_vS107 := Sum_vS107 + 1;
               end
               else                               UV_vS107[Index] := '*';          //Sum_vS107
               if (pos('S108', sHul_List) > 0) then
               begin
                  UV_vS108[Index] := '';
                  Sum_vS108 := Sum_vS108 + 1;
               end
               else                               UV_vS108[Index] := '*';          //Sum_vS108
               if (pos('C044', sHul_List) > 0) then
               begin
                    if ((qryBunju.FieldByName('dat_gmgn').AsString >= '20190124') AND
                        ( (qryBunju.FieldByName('cod_dc').AsString = '122810') or (qryBunju.FieldByName('cod_dc').AsString = '000917') or
                          (qryBunju.FieldByName('cod_dc').AsString = '122801') or (qryBunju.FieldByName('cod_dc').AsString = '126741') or
                          (qryBunju.FieldByName('cod_dc').AsString = '122884') or (qryBunju.FieldByName('cod_dc').AsString = '121496') or
                          (qryBunju.FieldByName('cod_dc').AsString = '120335') or (qryBunju.FieldByName('cod_dc').AsString = '430513') or
                          (qryBunju.FieldByName('cod_dc').AsString = '431062') or (qryBunju.FieldByName('cod_dc').AsString = '433141') or
                          (qryBunju.FieldByName('cod_dc').AsString = '431314') or (qryBunju.FieldByName('cod_dc').AsString = '430616') or
                          (qryBunju.FieldByName('cod_dc').AsString = '1133YY') or (qryBunju.FieldByName('cod_dc').AsString = '1133Y2') or
                          (qryBunju.FieldByName('cod_dc').AsString = '111YY3') or (qryBunju.FieldByName('cod_dc').AsString = '116048') or
                          (qryBunju.FieldByName('cod_dc').AsString = '11YYAC') or (qryBunju.FieldByName('cod_dc').AsString = '11YYAB') or
                          (qryBunju.FieldByName('cod_dc').AsString = '516133') or (qryBunju.FieldByName('cod_dc').AsString = '615361') or
                          (qryBunju.FieldByName('cod_dc').AsString = '713292') or
                         ((qryBunju.FieldByName('dat_gmgn').AsString >= '20190318') and (qryBunju.FieldByName('cod_dc').AsString = '127571')) )) then
                    begin
                       UV_vC044[Index] := '';
                       Sum_vC044 := Sum_vC044 + 1;
                    end
                    else UV_vC044[Index] := '*';
               end
               else                               UV_vC044[Index] := '*';          //Sum_vC044
               if (pos('C016', sHul_List) > 0) then
               begin
                  UV_vC016[Index] := '';
                  Sum_vC016 := Sum_vC016 + 1;
               end
               else                               UV_vC016[Index] := '*';          //Sum_vC016
               if (pos('S109', sHul_List) > 0) then
               begin
                  UV_vS109[Index] := '';
                  Sum_vS109 := Sum_vS109 + 1;
               end
               else                               UV_vS109[Index] := '*';          //Sum_vS109
               if (pos('S110', sHul_List) > 0) then
               begin
                  UV_vS110[Index] := '';
                  Sum_vS110 := Sum_vS110 + 1;
               end
               else                               UV_vS110[Index] := '*';          //Sum_vS110


               Inc(Index);

            End;
            Next;
         End;

         // Table과 Disconnect
         Close;

         UV_vNo[Index]     := '';
         UV_vJisa[Index]   := '';
         UV_vBUN[Index]    := '';
         UV_vName[Index]   := '';
         UV_vJumin[Index]  := '총  합  계';

         UV_vE021[Index] := Sum_vE021; UV_vS055[Index] := Sum_vS055; UV_vS066[Index] := Sum_vS066;
         UV_vU034[Index] := Sum_vU034; UV_vE016[Index] := Sum_vE016; UV_vC081[Index] := Sum_vC081; UV_vT038[Index] := Sum_vT038;
         UV_vY009[Index] := Sum_vY009; UV_vE019[Index] := Sum_vE019;
         UV_vSE16[Index] := Sum_vSE16; UV_vC038[Index] := Sum_vC038; UV_vS093[Index] := Sum_vS093; 
         UV_vS039[Index] := Sum_vS039; UV_vH038[Index] := Sum_vH038;
         UV_vH039[Index] := Sum_vH039; UV_vU049[Index] := Sum_vU049; UV_vC075[Index] := Sum_vC075; UV_vH031[Index] := Sum_vH031;
         UV_vC076[Index] := Sum_vC076; UV_vE050[Index] := Sum_vE050; UV_vU039[Index] := Sum_vU039; UV_vU040[Index] := Sum_vU040;
         UV_vU041[Index] := Sum_vU041; UV_vE051[Index] := Sum_vE051; UV_vE052[Index] := Sum_vE052; UV_vE053[Index] := Sum_vE053;
         UV_vE054[Index] := Sum_vE054; UV_vE055[Index] := Sum_vE055; UV_vE056[Index] := Sum_vE056; UV_vE057[Index] := Sum_vE057;
         UV_vE058[Index] := Sum_vE058; UV_vT005[Index] := Sum_vT005; UV_vS022[Index] := Sum_vS022; UV_vE049[Index] := Sum_vE049;
         UV_vS086[Index] := Sum_vS086; UV_vS087[Index] := Sum_vS087; UV_vS088[Index] := Sum_vS088;
         UV_vS089[Index] := Sum_vS089; UV_vC036[Index] := Sum_vC036;

         UV_vC065[Index] := Sum_vC065; UV_vC072[Index] := Sum_vC072; UV_vC079[Index] := Sum_vC079; UV_vS059[Index] := Sum_vS059;
         UV_vS060[Index] := Sum_vS060; UV_vS061[Index] := Sum_vS061; UV_vS062[Index] := Sum_vS062; UV_vS063[Index] := Sum_vS063;
         UV_vS070[Index] := Sum_vS070; UV_vS081[Index] := Sum_vS081; UV_vS098[Index] := Sum_vS098; UV_vS030[Index] := Sum_vS030;
         UV_vS031[Index] := Sum_vS031; UV_vS032[Index] := Sum_vS032; UV_vT018[Index] := Sum_vT018; UV_vE013[Index] := Sum_vE013;
         UV_vT021[Index] := Sum_vT021; UV_vT022[Index] := Sum_vT022; UV_vT023[Index] := Sum_vT023; UV_vT024[Index] := Sum_vT024;
         UV_vS094[Index] := Sum_vS094; UV_vE047[Index] := Sum_vE047; UV_vS076[Index] := Sum_vS076; UV_vS077[Index] := Sum_vS077;
         UV_vS078[Index] := Sum_vS078; UV_vE012[Index] := Sum_vE012; UV_vS085[Index] := Sum_vS085; UV_vSE26[Index] := Sum_vSE26;
         UV_vSE27[Index] := Sum_vSE27; UV_vSE28[Index] := Sum_vSE28; UV_vSE29[Index] := Sum_vSE29; UV_vS095[Index] := Sum_vS095;
         UV_vT026[Index] := Sum_vT026; UV_vT027[Index] := Sum_vT027; UV_vT028[Index] := Sum_vT028; UV_vT032[Index] := Sum_vT032;
         UV_vT033[Index] := Sum_vT033; UV_vT035[Index] := Sum_vT035; UV_vT036[Index] := Sum_vT036; UV_vH027[Index] := Sum_vH027;
         UV_vH028[Index] := Sum_vH028; UV_vE014[Index] := Sum_vE014; UV_vE059[Index] := Sum_vE059; UV_vE060[Index] := Sum_vE060;
         UV_vE061[Index] := Sum_vE061; UV_vE062[Index] := Sum_vE062; UV_vE063[Index] := Sum_vE063; UV_vE064[Index] := Sum_vE064;
         UV_vE065[Index] := Sum_vE065; UV_vT044[Index] := Sum_vT044; UV_vT045[Index] := Sum_vT045; UV_vT046[Index] := Sum_vT046;
         UV_vT047[Index] := Sum_vT047; UV_vT048[Index] := Sum_vT048; UV_vE066[Index] := Sum_vE066; UV_vE067[Index] := Sum_vE067;
         UV_vT049[Index] := Sum_vT049; UV_vU048[Index] := Sum_vU048; UV_vS092[Index] := Sum_vS092; UV_vT050[Index] := Sum_vT050;
         UV_vC053[Index] := Sum_vC053; UV_vC055[Index] := Sum_vC055; UV_vT039[Index] := Sum_vT039;
         UV_vU019[Index] := Sum_vU019; UV_vC018[Index] := Sum_vC018;
         UV_vE010[Index] := Sum_vE010; UV_vS023[Index] := Sum_vS023; UV_vS038[Index] := Sum_vS038; UV_vS040[Index] := Sum_vS040;
         UV_vS053[Index] := Sum_vS053; UV_vS054[Index] := Sum_vS054; UV_vSE38[Index] := Sum_vSE38; UV_vT015[Index] := Sum_vT015;
         UV_vS029[Index] := Sum_vS029; UV_vDesc_dc[Index] := '';     UV_vY005[Index] := Sum_vY005; UV_vY008[Index] := Sum_vY008;
         UV_vSampNo[Index]  := '';     UV_vDRUC[Index] := Sum_vDRUC; UV_vC054[Index] := Sum_vC054; UV_vS096[Index] := Sum_vS096;
         UV_vS097[Index] := Sum_vS097; UV_vT051[Index] := Sum_vT051; UV_vT052[Index] := Sum_vT052; UV_vT053[Index] := Sum_vT053;
         UV_vT054[Index] := Sum_vT054; UV_vT055[Index] := Sum_vT055; UV_vU015[Index] := Sum_vU015; UV_vU016[Index] := Sum_vU016;
         UV_vT056[Index] := Sum_vT056; UV_vT057[Index] := Sum_vT057; UV_vH046[Index] := Sum_vH046; UV_vS100[Index] := Sum_vS100;
         UV_vT030[Index] := Sum_vT030; UV_vT059[Index] := Sum_vT059; UV_vS103[Index] := Sum_vS103; UV_vC016[Index] := Sum_vC016;
         UV_vS105[Index] := Sum_vS105; UV_vS106[Index] := Sum_vS106; UV_vS107[Index] := Sum_vS107; UV_vS108[Index] := Sum_vS108;
         UV_vC044[Index] := Sum_vC044; UV_vS109[Index] := Sum_vS109; UV_vS110[Index] := Sum_vS110;
         Inc(index);
      end
      else
      begin
         // 자료가 없음을 표시
         GF_MsgBox('Information', 'NODATA');
         exit;
      end;  // if RecordCount > 0 then
//      Close;
   end;  // with qry_gulkwa do

   // Grid에 자료를 할당
   grdMaster.Rows := index;
   
   // Query Mode & Msg
   if Sender = btnQuery then UP_SetMode('QUERY');
end;

procedure TfrmLD2Q04.UP_Change(Sender: TObject);
var sName : String;
begin
  inherited;

   if Sender = edtDc then
   begin
      if GF_DancheEdit(edtDc, sName) then
         edtDesc_dc.Text := sName;
   end;

end;

procedure TfrmLD2Q04.UP_Click(Sender: TObject);
var sCode, sName : String;
begin
  inherited;
   if Sender = btnDc then
   begin
      if GF_DancheClick(Self, sCode, sName) then
      begin
         edtDc.Text  := sCode;
         edtDesc_dc.Text := sName;
      end;
   end
   else
   if Sender = btnBdate then GF_CalendarClick(edtBDate);
end;

procedure TfrmLD2Q04.btnPrintClick(Sender: TObject);
begin
  inherited;

  frmLD2Q041 := TfrmLD2Q041.Create(Self);
  frmLD2Q042 := TfrmLD2Q042.Create(Self);
  frmLD2Q043 := TfrmLD2Q043.Create(Self);
  frmLD2Q046 := TfrmLD2Q046.Create(Self);
  frmLD2Q047 := TfrmLD2Q047.Create(Self);
  frmLD2Q048 := TfrmLD2Q048.Create(Self);
  frmLD2Q049 := TfrmLD2Q049.Create(Self);
  frmLD2Q0491 := TfrmLD2Q0491.Create(Self);
  frmLD2Q0492 := TfrmLD2Q0492.Create(Self);
 // frmLD2Q0492.QuickRep.Print;


  if RBtn_preveiw.Checked = True then
     Begin
        //QRCompositeReport.Preview;
        frmLD2Q041.QuickRep.Preview;
        frmLD2Q042.QuickRep.Preview;
        frmLD2Q043.QuickRep.Preview;
        frmLD2Q046.QuickRep.Preview;
        frmLD2Q047.QuickRep.Preview;
        frmLD2Q048.QuickRep.Preview;
        frmLD2Q049.QuickRep.Preview;
        frmLD2Q0491.QuickRep.Preview;
        frmLD2Q0492.QuickRep.Preview;
     End
  else
     Begin
        //QRCompositeReport.Print;
        frmLD2Q041.QuickRep.Print;
        frmLD2Q042.QuickRep.Print;
        frmLD2Q043.QuickRep.Print;
        frmLD2Q046.QuickRep.Print;
        frmLD2Q047.QuickRep.Print;
        frmLD2Q048.QuickRep.Print;
        frmLD2Q049.QuickRep.Print;
        frmLD2Q0491.QuickRep.Print;
        frmLD2Q0492.QuickRep.Print;
     End;
end;

procedure TfrmLD2Q04.FormActivate(Sender: TObject);
begin
   inherited;
   BunjuNo1.Text := '0001';
   BunjuNo2.Text := '9999';
   edtBdate.SetFocus;
end;

procedure TfrmLD2Q04.QRCompositeReportAddReports(Sender: TObject);
begin
  inherited;
//frmLD2Q041 := TfrmLD2Q041.Create(Self);
//frmLD2Q043 := TfrmLD2Q042.Create(Self);
//frmLD2Q042 := TfrmLD2Q043.Create(Self);

  frmLD2Q041  := TfrmLD2Q041.Create(Self);
  frmLD2Q042  := TfrmLD2Q042.Create(Self);
  frmLD2Q043  := TfrmLD2Q043.Create(Self);
  frmLD2Q046  := TfrmLD2Q046.Create(Self);
  frmLD2Q047  := TfrmLD2Q047.Create(Self);
  frmLD2Q048  := TfrmLD2Q048.Create(Self);
  frmLD2Q049  := TfrmLD2Q049.Create(Self);
  frmLD2Q0491 := TfrmLD2Q0491.Create(Self);
  frmLD2Q0492 := TfrmLD2Q0492.Create(Self);

  with QRCompositeReport do
  begin
//  Reports.Add(frmLD2Q041.QuickRep);
//  Reports.Add(frmLD2Q042.QuickRep);
//  Reports.Add(frmLD2Q043.QuickRep);
    Reports.Add(frmLD2Q041.QuickRep);
    Reports.Add(frmLD2Q042.QuickRep);
    Reports.Add(frmLD2Q043.QuickRep);
    Reports.Add(frmLD2Q046.QuickRep);
    Reports.Add(frmLD2Q047.QuickRep);
    Reports.Add(frmLD2Q048.QuickRep);
    Reports.Add(frmLD2Q049.QuickRep);
    Reports.Add(frmLD2Q0491.QuickRep);
    Reports.Add(frmLD2Q0492.QuickRep);
  end;
end;

procedure TfrmLD2Q04.Btn_NamePrintClick(Sender: TObject);
begin
   inherited;
   if RBtn_1.Checked then
   begin
      frmLD2Q044 := TfrmLD2Q044.Create(Self);
      if RBtn_preveiw.Checked then frmLD2Q044.QuickRep.Preview
      else                         frmLD2Q044.QuickRep.Print;
   end
   else
   begin
      frmLD2Q045 := TfrmLD2Q045.Create(Self);
  //    frmLD2Q045.QuickRep.Preview;

      if RBtn_preveiw.Checked then frmLD2Q045.QuickRep.Preview
      else                         frmLD2Q045.QuickRep.Print;
   end;
end;

function TfrmLD2Q04.UF_hangmokList : String;
var
   sTemp, sHmCode :string;
   vCod_chuga : Variant;
   iRet, i, J, K : integer;
begin
   result := ''; sTemp := '';

   with qryPf_hm do
   begin
      // 1. 혈액에 대한 검사항목 추출
      if qryBunju.FieldByName('cod_hul').AsString <> '' then
      begin
         Active := False;
         ParamByName('COD_PF').AsString := qryBunju.FieldByName('cod_hul').AsString;
         Active := True;

         if RecordCount > 0 then
         begin
            while not Eof do
            begin
               if copy(FieldByName('COD_HM').AsString,1,2) <> 'JJ' then
               sTemp := sTemp + FieldByName('COD_HM').AsString;
               Next;
            end;
         end;
      end;

      // 2. 종양에 대한 검사항목 추출
      if qryBunju.FieldByName('Cod_cancer').AsString <> '' then
      begin
         Active := False;
         ParamByName('COD_PF').AsString := qryBunju.FieldByName('Cod_cancer').AsString;
         Active := True;

         if RecordCount > 0 then
         begin
            while not Eof do
            begin
               if copy(FieldByName('COD_HM').AsString,1,2) <> 'JJ' then
               sTemp := sTemp + FieldByName('COD_HM').AsString;
               Next;
            end;
         end;
      end;

      // 3. 장비에 대한 검사항목 추출
      if qryBunju.FieldByName('Cod_jangbi').AsString  <> '' then
      begin
         Active := False;
         ParamByName('COD_PF').AsString := qryBunju.FieldByName('Cod_jangbi').AsString;
         Active := True;

         if RecordCount > 0 then
         begin
            while not Eof do
            begin
               if copy(FieldByName('COD_HM').AsString,1,2) <> 'JJ' then
               sTemp := sTemp + FieldByName('COD_HM').AsString;
               Next;
            end;
         end;
      end;
      Active := False;
   end;

   // 3. 추가코드에 대한 검사항목 추출
   sTemp := sTemp + qryBunju.FieldByName('Cod_chuga').AsString;;

   // 4. 항목코드에 대한 검사항목 추출
   sHmCode := '';
   if qryBunju.FieldByName('Gubn_nosin').AsString = '1' then
      sHmCode := UF_No_Hangmok(qryBunju.FieldByName('Dat_gmgn').AsString, '1', qryBunju.FieldByName('Gubn_nsyh').AsInteger)
   else if qryBunju.FieldByName('Gubn_adult').AsString = '1' then
      sHmCode := UF_No_Hangmok(qryBunju.FieldByName('Dat_gmgn').AsString, '4', qryBunju.FieldByName('Gubn_adyh').AsInteger);

   if qryBunju.FieldByName('Gubn_life').AsString = '1' then
      sHmCode := sHmCode + UF_No_Hangmok(qryBunju.FieldByName('Dat_gmgn').AsString, '7', qryBunju.FieldByName('Gubn_lfyh').AsInteger);

   if qryBunju.FieldByName('Gubn_bogun').AsString = '1' then
      sHmCode := sHmCode + UF_No_Hangmok(qryBunju.FieldByName('Dat_gmgn').AsString, '3',qryBunju.FieldByName('Gubn_bgyh').AsInteger);

   if qryBunju.FieldByName('Gubn_agab').AsString = '1' then
      sHmCode := sHmCode + UF_No_Hangmok(qryBunju.FieldByName('Dat_gmgn').AsString, '5',qryBunju.FieldByName('Gubn_agyh').AsInteger);

   if (qryBunju.FieldByName('Gubn_tkgm').AsString = '1') or (qryBunju.FieldByName('Gubn_tkgm').AsString = '2') then
   begin
      qryTkgum.Active := False;
      qryTkgum.ParamByName('cod_jisa').AsString  := qryBunju.FieldByName('Cod_jisa').AsString;
      qryTkgum.ParamByName('num_jumin').AsString := qryBunju.FieldByName('Num_jumin').AsString;
      qryTkgum.ParamByName('dat_gmgn').AsString  := qryBunju.FieldByName('Dat_gmgn').AsString;
      qryTkgum.Active := True;
      if qryTkgum.RecordCount > 0 then
      begin
         I := Length(qryTkgum.FieldByName('Cod_prf').AsString);
         J := Round(I / 4);
         For K := 0 To J - 1 Do
         Begin
           With qryProfile do
           Begin
              Close;
              ParamByName('In_Cod_Pf').AsString := Copy(qryTkgum.FieldByName('Cod_Prf').AsString,K * 4 + 1, 4);
              Open;
              For I := 1 To Recordcount Do
              Begin
                 if pos(FieldByName('Cod_hm').AsString, sHmCode) = 0 then
                    sHmCode := sHmCode + FieldByName('Cod_hm').AsString;
                 Next;
              End;
              Close;
            end;
         end;
         sHmCode := sHmCode + qryTkgum.FieldByName('cod_chuga').AsString;
      end;
      qryTkgum.Active := False;
   end;

   if Trim(sHmCode) <> '' then
   begin
      iRet := GF_MulToSingle(sHmCode, 4, vCod_chuga);
      for i := 0 to iRet-1 do
      begin
         if copy(vCod_chuga[i],1,2) <> 'JJ' then
         sTemp := sTemp + vCod_chuga[i];
      end;
   end;
   result := sTemp;
end;

function TfrmLD2Q04.UF_No_Hangmok(sDate, sGubun : String; iYh : Integer): String;
begin
   Result := '';
   with qryNo_hangmok do
   begin
      Active := False;
      ParamByName('dat_apply').AsString   := sDate;
      ParamByName('gubn_code').AsString   := sGubun;
      ParamByName('gubn_yh').AsInteger    := iYh;
      Active := True;
      if RecordCount > 0 then
      begin
         Result := FieldByName('desc_hul').AsString;
      end;
      Active := False;
   end;
end;

procedure TfrmLD2Q04.SBut_ExcelClick(Sender: TObject);
var
  XL,WorkBook: Variant;
  i : integer;
  ArrV3 : OleVariant;
  Row,Col : Integer;
begin
   inherited;
   Screen.Cursor:= crHourGlass;
   try
      XL:= CreateOleObject('Excel.Application');
   except
      Application.MessageBox('Excel이 설치되어 있지 않습니다. 먼저 Excel을 설치하세요.',
                             '오류', MB_OK or MB_ICONERROR);
      Screen.Cursor  := crDefault;
      Exit;
   end;

   Gauge2.MaxValue := grdMaster.Rows;
   Gauge2.Progress := 1;
   Application.ProcessMessages;
   try
      WorkBook := XL.WorkBooks.Add;

      //Data import
      ArrV3 := VarArrayCreate([0, grdMaster.Rows + 1, 0, grdMaster.Cols], varOleStr);

      I := 0;
      for Row := 0 to grdMaster.Rows + 1 do
      begin
         if Row = 0 then
         begin
            for Col := 0 to grdMaster.Cols - 1 do
               ArrV3[Row, Col] := grdMaster.Col[Col + 1].Heading;
         end
         else
         begin
            for Col := 0 to grdMaster.Cols do
            begin
               Application.ProcessMessages;
               ArrV3[Row, Col] := grdMaster.cell[Col + 1, Row];
            end;
         end;
         Gauge2.Progress:= i;
         Application.ProcessMessages;
         Inc(I);
      end;
      XL.Range[XL.Cells[1, 1], XL.Cells[grdMaster.Rows + 1, grdMaster.Cols]].Value := ArrV3;


      XL.DisplayAlerts := True;
      XL.Visible:= True;
   finally
      Application.ProcessMessages;
      Screen.Cursor  := crDefault;
   end;
end;



end.
