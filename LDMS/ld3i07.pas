//==============================================================================
// 프로그램 설명 : 외주항목 혈액결과 입력
// 시스템        : 통합검진
// 수정일자      : 2006.08.11
// 수정자        : 구수정
// 수정내용      : 혈액결과 업로드...
// 참고사항      :
//==============================================================================
// 수정일자      : 2007.06.01
// 수정자        : 구수정
// 수정내용      : E025추가...
// 참고사항      :
//==============================================================================
// 수정일자      : 2007.12.13
// 수정자        : 유동구
// 수정내용      : S007,S008 추가...
// 참고사항      :
//==============================================================================
// 수정일자      : 2008.11.13
// 수정자        : 송재호
// 수정내용      : E005->S009 변경
// 참고사항      :
//==============================================================================
// 수정일자      : 2009.06.29
// 수정자        : 김승철
// 수정내용      : H029 추가
//==============================================================================
// 수정일자      : 2009.07.17
// 수정자        : 김승철
// 수정내용      : U023, U028, U037, E019, E005, C070, T034, T035 추가
//==============================================================================
// 수정일자      : 2010.03.25
// 수정자        : 구수정
// 수정내용      : T038, C081 추가
//==============================================================================
// 수정일자      : 2010.04.24
// 수정자        : 정용수
// 수정내용      : E051, E052,E055,E056 추가
//==============================================================================
// 수정일자      : 2010.05.18
// 수정자        : 정용수
// 수정내용      : S022추가
//==============================================================================
// 수정일자      : 2010.05.31
// 수정자        : 정용수
// 수정내용      : S080추가
//==============================================================================
// 수정일자      : 2010.06.29
// 수정자        : 김희석
// 수정내용      : E049,E005 추가
//==============================================================================
// 수정일자      : 2010.07.08
// 수정자        : 김희석
// 수정내용      : T039 추가
//==============================================================================
// 수정일자      : 2010.11.18
// 수정자        : 김희석
// 수정내용      : S038,SE38, U026 추가
//==============================================================================
// 수정일자      : 2010.12.07
// 수정자        : 김희석
// 수정내용      : S086,S087,S088,S089 추가
//==============================================================================
// 수정일자      : 2010.12.07
// 수정자        : 김희석
// 수정내용      : S086,S087,S088,S089 추가
//==============================================================================
// 수정일자      : 2012.08.23
// 수정자        : 김희석
// 수정내용      : C072,E053,E065,E066,E067,T033,T044,T045,T046,T047,T048,T049 추가 
//==============================================================================
// 수정일자      : 2012.12.21
// 수정자        : 김희석
// 수정내용      : S021추가
//==============================================================================
// 수정일자      : 2014.04.09
// 수정자        : 곽윤설
// 수정내용      : T043추가
//==============================================================================
// 수정일자      : 2014.05.12
// 수정자        : 곽윤설
// 수정내용      : S098 추가   [본원-최정미]
//==============================================================================
// 수정일자      : 2014.05.16
// 수정자        : 곽윤설
// 수정내용      : Y005,Y008추가
//==============================================================================
// 수정일자      : 2014.06.21
// 수정자        : 곽윤설
// 수정내용      : SE12->C038 코드변경  / S094,S095 추가 [본원-최정미]
//==============================================================================
// 수정일자      : 2014.11.14
// 수정자        : 곽윤설
// 수정내용      : T051 T052 T053 T054 추가 [본원-최정미]
//==============================================================================
// 수정일자      : 2014.11.15
// 수정자        : 곽윤설
// 수정내용      : T055 추가 [본원-최정미]
//==============================================================================
// 수정일자      : 2015.02.12
// 수정자        : 곽윤설
// 수정내용      : C022C023C031 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2015.04.02
// 수정자        : 곽윤설
// 수정내용      : C031->C080 으로 변경
// 참고사항      :
//==============================================================================
// 수정일자      : 2015.04.11
// 수정자        : 곽윤설
// 수정내용      : U015, U016 추가
// 참고사항      :
//==============================================================================
// 수정일자      : 2015.04.14
// 수정자        : 곽윤설
// 수정내용      : U062 추가
// 참고사항      : 삼광외주 리스트가 아닌 urine외주항목 리스트에서 출력, [본원-박연숙]
//==============================================================================
// 수정일자      : 2015.04.30
// 수정자        : 곽윤설
// 수정내용      : C022, C023, C080 삭제
// 참고사항      : 한의 재단진단검사의학팀1500363 [본원-최정미]
//==============================================================================
// 수정일자      : 2015.07.29
// 수정자        : 곽윤설
// 수정내용      : T056, T057, H038, H039 추가
// 참고사항      : [본원-박연숙]
//==============================================================================
// 수정일자      : 2015.11.11
// 수정자        : 곽윤설
// 수정내용      : E058 추가
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 20160130
// 수정자        : 박수지
// 수정내용      : U069, U070, U067, U068, U071, U066, H046      (7개 추가)
// 참고사항      : [본원-최정미]
//==============================================================================
// 수정일자      : 2016001
// 수정자        : 박수지
// 수정내용      : U047 추가
// 참고사항      : 한의 재단진단검사의학팀1600370
//==============================================================================
// 수정일자      : 20160418
// 수정자        : 박수지
// 수정내용      : t023 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20160419
// 수정자        : 박수지
// 수정내용      : S085 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20160518
// 수정자        : 박수지
// 수정내용      : E047-PAP E050-aldosterone(serum) E054-Progesterone C015-Aldolase
//                 C053-T CO2 C054-이온화칼슘 S062-widal O S063-widal H
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20161102
// 수정자        : 박수지
// 수정내용      : T028, T030 Transfer 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20170613
// 수정자        : 박수지
// 수정내용      : S030, S031 Transfer 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20170807
// 수정자        : 박수지
// 수정내용      : U074 Transfer 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
// 수정일자      : 20170809
// 수정자        : 박수지
// 수정내용      : C016 Transfer 추가
// 참고사항      : 본원 진단검사의학팀 최은영
//==============================================================================
unit LD3I07;



interface

uses
  Windows, Messages,  SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  ORSingle, Menus, Buttons, ComCtrls, ToolWin, Db, DBTables, Grids, DBGrids,
  Grids_ts, TSGrid, ExtCtrls, StdCtrls, Mask, DateEdit, TeEngine, Series,
  TeeProcs, Chart, ComObj, ValEdit, Gauges;



type
  TfrmLD3I07 = class(TfrmSingle)
    OpenDialog: TOpenDialog;
    GroupBox1: TGroupBox;
    gkPie: TGauge;
    pnlJisa: TPanel;
    Btn_Insert: TBitBtn;
    pnlMaster: TPanel;
    btnDESC_DEPT: TSpeedButton;
    btnStart: TBitBtn;
    Panel5: TPanel;
    edtFile: TEdit;
    Panel3: TPanel;
    Panel6: TPanel;
    qrdSPList: TtsGrid;
    qryGumgin: TQuery;
    qryGulkwa: TQuery;
    qryU_Gulkwa: TQuery;
    TG_gumgin: TStringGrid;
    qrdSList: TtsGrid;
    Panel2: TPanel;
  procedure FormCreate(Sender: TObject);
    procedure btnDESC_DEPTClick(Sender: TObject);
    procedure Btn_InsertClick(Sender: TObject);
    procedure qrdSListCellLoaded(Sender: TObject; DataCol,
      DataRow: Integer; var Value: Variant);
    procedure qrdSPListCellLoaded(Sender: TObject; DataCol,
      DataRow: Integer; var Value: Variant);
    procedure btnStartClick(Sender: TObject);

 private
    { Private declarations }
    UV_sJisa : String;
    Excel, Worksheet  : Variant;

    UV_vS001, UV_vS002, UV_vS003, UV_vS004, UV_vS005, UV_vS006 : Variant;
    UV_vSP001, UV_vSP002, UV_vSP003, UV_vSP004, UV_vSP005, UV_vSP006 : Variant;
    
    procedure UP_SVarMemSet(iLength : Integer);
    procedure UP_SPVarMemSet(iLength : Integer);


  public
    { Public declarations }
    UV_sValue  : array[1..8] of String;

  end;


var
  frmLD3I07 : TfrmLD3I07;

implementation

uses ZZFunc, ZZComm, MdmsFunc;


{$R *.DFM}
  

procedure TfrmLD3I07.FormCreate(Sender: TObject);
begin
   inherited;

   // 전체(00)일경우 본사를 기준으로 작업
   if GV_sJisa = '00' then UV_sJisa := copy(GV_sUserId,1,2)
   else                    UV_sJisa := GV_sJisa;
end;

procedure TfrmLD3I07.UP_SVarMemSet(iLength : Integer);
begin
   // Variant Memory Allocation
   if iLength = 0 then
   begin
      UV_vS001 := VarArrayCreate([0, 0], varOleStr);
      UV_vS002 := VarArrayCreate([0, 0], varOleStr);
      UV_vS003 := VarArrayCreate([0, 0], varOleStr);
      UV_vS004 := VarArrayCreate([0, 0], varOleStr);
      UV_vS005 := VarArrayCreate([0, 0], varOleStr);
      UV_vS006 := VarArrayCreate([0, 0], varOleStr);
   end
   else
   begin
      VarArrayRedim(UV_vS001, iLength);
      VarArrayRedim(UV_vS002, iLength);
      VarArrayRedim(UV_vS003, iLength);
      VarArrayRedim(UV_vS004, iLength);
      VarArrayRedim(UV_vS005, iLength);
      VarArrayRedim(UV_vS006, iLength);
   end;
end;
procedure TfrmLD3I07.qrdSListCellLoaded(Sender: TObject; DataCol,
  DataRow: Integer; var Value: Variant);
begin
   inherited;
   case DataCol of
      1 : Value := UV_vS001[DataRow - 1];
      2 : Value := UV_vS002[DataRow - 1];
      3 : Value := UV_vS003[DataRow - 1];
      4 : Value := UV_vS004[DataRow - 1];
      5 : Value := UV_vS005[DataRow - 1];
      6 : Value := UV_vS006[DataRow - 1];
   end;
end;
procedure TfrmLD3I07.UP_SPVarMemSet(iLength : Integer);
begin
   // Variant Memory Allocation
   if iLength = 0 then
   begin
      UV_vSP001 := VarArrayCreate([0, 0], varOleStr);
      UV_vSP002 := VarArrayCreate([0, 0], varOleStr);
      UV_vSP003 := VarArrayCreate([0, 0], varOleStr);
      UV_vSP004 := VarArrayCreate([0, 0], varOleStr);
      UV_vSP005 := VarArrayCreate([0, 0], varOleStr);
      UV_vSP006 := VarArrayCreate([0, 0], varOleStr);
   end
   else
   begin
      VarArrayRedim(UV_vSP001, iLength);
      VarArrayRedim(UV_vSP002, iLength);
      VarArrayRedim(UV_vSP003, iLength);
      VarArrayRedim(UV_vSP004, iLength);
      VarArrayRedim(UV_vSP005, iLength);
      VarArrayRedim(UV_vSP006, iLength);
   end;
end;
procedure TfrmLD3I07.qrdSPListCellLoaded(Sender: TObject; DataCol,
  DataRow: Integer; var Value: Variant);
begin
   inherited;
   case DataCol of
      1 : Value := UV_vSP001[DataRow - 1];
      2 : Value := UV_vSP002[DataRow - 1];
      3 : Value := UV_vSP003[DataRow - 1];
      4 : Value := UV_vSP004[DataRow - 1];
      5 : Value := UV_vSP005[DataRow - 1];
      6 : Value := UV_vSP006[DataRow - 1];
   end;
end;

procedure TfrmLD3I07.btnDESC_DEPTClick(Sender: TObject);
begin
   inherited;
   if OpenDialog.Execute = False then
      exit;
   edtFile.Text := OpenDialog.FileName;
end;

procedure TfrmLD3I07.btnStartClick(Sender: TObject);
var
  icol, sCol, iRow, sRow : Integer;
  sLine, FileName, sSheetName : String;
begin
   Screen.Cursor := crHourGlass;
   sCol := 0;  sRow := 0;
   try
      Excel:= CreateOleObject('Excel.Application');
//      Excel.Visible := True;
      Excel.Workbooks.Open(OpenDialog.FileName);
      if Trim(sSheetName) = '' Then
        Worksheet := Excel.Workbooks[1].WorkSheetS[Excel.WorkBooks[1].Worksheets[1].Name]
      else
        Worksheet := Excel.Workbooks[1].WorkSheetS[SSheetName];
   except
      MessageDlg('Excel이 정상적으로 수행되지 않았습니다.' + Chr(13) +
                         '환경설정을 다시 하시기 바랍니다.',mtError,[mbOk], 0);
   end;
   For iRow := 1 to 65000 do
   begin
      if WorkSheet.Cells[iRow,1].Text <> '' then
         Inc(sRow)
      else
         Break;
   end;
   For iCol := 1 to 20 do
   begin
      if WorkSheet.Cells[1,iCol].Text <> '' then
         Inc(sCol)
      else
         Break;
   end;

   TG_gumgin.RowCount := sRow;
   TG_gumgin.ColCount := sCol;
   
   For iRow := 0 to sRow do
   begin
      For iCol := 0 to sCol do
         TG_gumgin.Cells[iCol,iRow] := Trim(WorkSheet.Cells[iRow + 1,iCol + 1].Text);
   end;

   if not VarIsEmpty(Excel) then
     Excel.Quit;
   Screen.Cursor := crDefault;
end;


procedure TfrmLD3I07.Btn_InsertClick(Sender: TObject);
var
    sGlkwa : String;
    I, iTemp, sIndex, spIndex: Integer;
begin
   inherited;
   sIndex := 0;
   spIndex := 0;
   if TG_gumgin.RowCount = 0 then
   begin
      showmessage('데이터가 존재하지 않습니다.');
      exit;
   end;
   if not GF_MsgBox('Confirmation', 'Transfer를 시작 하시겠습니까.?') then exit;
   gkPie.MaxValue := TG_gumgin.RowCount -1;
   gkPie.Progress := 0;

   for I := 1 to TG_gumgin.RowCount -1 do
   begin
      gkPie.Progress := gkPie.Progress + 1;
      // DB 작업
      try

         // 초기결과값.
         with qryGulkwa do
         begin
              Active := False;
              ParamByName('cod_bjjs').AsString   := '15';
              qryGulkwa.ParamByName('dat_bunju').AsString  := TG_gumgin.Cells[0,I];
              qryGulkwa.ParamByName('num_bunju').AsString  := TG_gumgin.Cells[3,I];

              //part구분
              if    (TG_gumgin.Cells[7,I] = 'C050') or (TG_gumgin.Cells[7,I] = 'C051')
                 or (TG_gumgin.Cells[7,I] = 'C052') or (TG_gumgin.Cells[7,I] = 'C065')
                 or (TG_gumgin.Cells[7,I] = 'C070') or (TG_gumgin.Cells[7,I] = 'C081')
                 or (TG_gumgin.Cells[7,I] = 'C072') or (TG_gumgin.Cells[7,I] = 'C083')
                 or (TG_gumgin.Cells[7,I] = 'C053') then
                      ParamByName('gubn_part').AsString  := '01'
              Else if (TG_gumgin.Cells[7,I] = 'H027') or (TG_gumgin.Cells[7,I] = 'H028')
                   or (TG_gumgin.Cells[7,I] = 'H029') or (TG_gumgin.Cells[7,I] = 'H038')
                   or (TG_gumgin.Cells[7,I] = 'H039') or (TG_gumgin.Cells[7,I] = 'H046')then
                      ParamByName('gubn_part').AsString  := '02'
              Else if (TG_gumgin.Cells[7,I] = 'U023') or (TG_gumgin.Cells[7,I] = 'U027')
                   or (TG_gumgin.Cells[7,I] = 'U028') or (TG_gumgin.Cells[7,I] = 'U037')
                   or (TG_gumgin.Cells[7,I] = 'U043') or (TG_gumgin.Cells[7,I] = 'U034')
                   or (TG_gumgin.Cells[7,I] = 'U015') or (TG_gumgin.Cells[7,I] = 'U016')
                   or (TG_gumgin.Cells[7,I] = 'U062') or (TG_gumgin.Cells[7,I] = 'Y005')
                   or (TG_gumgin.Cells[7,I] = 'U066') or (TG_gumgin.Cells[7,I] = 'U067')
                   or (TG_gumgin.Cells[7,I] = 'U068') or (TG_gumgin.Cells[7,I] = 'U069')
                   or (TG_gumgin.Cells[7,I] = 'U070') or (TG_gumgin.Cells[7,I] = 'U071')
                   or (TG_gumgin.Cells[7,I] = 'Y008') or (TG_gumgin.Cells[7,I] = 'U047')
                   or (TG_gumgin.Cells[7,I] = 'U045') or (TG_gumgin.Cells[7,I] = 'U074') then
                      ParamByName('gubn_part').AsString  := '03'
              Else if (TG_gumgin.Cells[7,I] = 'T005') or (TG_gumgin.Cells[7,I] = 'SE13')
                   or (TG_gumgin.Cells[7,I] = 'SE11')
                   or (TG_gumgin.Cells[7,I] = 'C044') or (TG_gumgin.Cells[7,I] = 'E019')
                   or (TG_gumgin.Cells[7,I] = 'E049') or (TG_gumgin.Cells[7,I] = 'T044')
                   or (TG_gumgin.Cells[7,I] = 'T045') or (TG_gumgin.Cells[7,I] = 'T046')
                   or (TG_gumgin.Cells[7,I] = 'T047') or (TG_gumgin.Cells[7,I] = 'T048')
                   or (TG_gumgin.Cells[7,I] = 'T049') or (TG_gumgin.Cells[7,I] = 'T051')
                   or (TG_gumgin.Cells[7,I] = 'T052') or (TG_gumgin.Cells[7,I] = 'T053')
                   or (TG_gumgin.Cells[7,I] = 'T054') or (TG_gumgin.Cells[7,I] = 'T056')
                   or (TG_gumgin.Cells[7,I] = 'T057') or (TG_gumgin.Cells[7,I] = 'T023')
                   or (TG_gumgin.Cells[7,I] = 'E050') or (TG_gumgin.Cells[7,I] = 'T059')
                   or (TG_gumgin.Cells[7,I] = 'S030') or (TG_gumgin.Cells[7,I] = 'S031') then
                      ParamByName('gubn_part').AsString  := '04'
              Else if (TG_gumgin.Cells[7,I] = 'S078') or (TG_gumgin.Cells[7,I] = 'C020')
                   or (TG_gumgin.Cells[7,I] = 'C035') or (TG_gumgin.Cells[7,I] = 'S010')
                   or (TG_gumgin.Cells[7,I] = 'S077') or (TG_gumgin.Cells[7,I] = 'S019')
                   or (TG_gumgin.Cells[7,I] = 'S018') or (TG_gumgin.Cells[7,I] = 'SE28')
                   or (TG_gumgin.Cells[7,I] = 'SE27') or (TG_gumgin.Cells[7,I] = 'SE26')
                   or (TG_gumgin.Cells[7,I] = 'SE29') or (TG_gumgin.Cells[7,I] = 'T034')
                   or (TG_gumgin.Cells[7,I] = 'T035') or (TG_gumgin.Cells[7,I] = 'T055')
                   or (TG_gumgin.Cells[7,I] = 'T038') or (TG_gumgin.Cells[7,I] = 'E051')
                   or (TG_gumgin.Cells[7,I] = 'E052') or (TG_gumgin.Cells[7,I] = 'E055')
                   or (TG_gumgin.Cells[7,I] = 'E056') or (TG_gumgin.Cells[7,I] = 'S022')
                   or (TG_gumgin.Cells[7,I] = 'S086') or (TG_gumgin.Cells[7,I] = 'S087')
                   or (TG_gumgin.Cells[7,I] = 'S088') or (TG_gumgin.Cells[7,I] = 'S089')
                   or (TG_gumgin.Cells[7,I] = 'E053') or (TG_gumgin.Cells[7,I] = 'E065')
                   or (TG_gumgin.Cells[7,I] = 'E066') or (TG_gumgin.Cells[7,I] = 'E067')
                   or (TG_gumgin.Cells[7,I] = 'T033') or (TG_gumgin.Cells[7,I] = 'T039')
                   or (TG_gumgin.Cells[7,I] = 'S021') or (TG_gumgin.Cells[7,I] = 'T043')
                   or (TG_gumgin.Cells[7,I] = 'E058') or (TG_gumgin.Cells[7,I] = 'S085')
                   or (TG_gumgin.Cells[7,I] = 'E047') or (TG_gumgin.Cells[7,I] = 'E054')
                   or (TG_gumgin.Cells[7,I] = 'T028') or (TG_gumgin.Cells[7,I] = 'T030')
                   or (TG_gumgin.Cells[7,I] = 'S103') then
                      ParamByName('gubn_part').AsString  := '05'
              Else if (TG_gumgin.Cells[7,I] = 'P007') or (TG_gumgin.Cells[7,I] = 'S007')
                   or (TG_gumgin.Cells[7,I] = 'S008') or (TG_gumgin.Cells[7,I] = 'S080')
                   or (TG_gumgin.Cells[7,I] = 'S098') or (TG_gumgin.Cells[7,I] = 'S094')
                   or (TG_gumgin.Cells[7,I] = 'S095') or (TG_gumgin.Cells[7,I] = 'S062')
                   or (TG_gumgin.Cells[7,I] = 'S063')then
                      ParamByName('gubn_part').AsString  := '07'
              Else if (TG_gumgin.Cells[7,I] = 'S066') or (TG_gumgin.Cells[7,I] = 'C037')
                   or (TG_gumgin.Cells[7,I] = 'S027') or (TG_gumgin.Cells[7,I] = 'C040')
                   or (TG_gumgin.Cells[7,I] = 'T012') or (TG_gumgin.Cells[7,I] = 'E027')
                   or (TG_gumgin.Cells[7,I] = 'S039') or (TG_gumgin.Cells[7,I] = 'E010')
                   or (TG_gumgin.Cells[7,I] = 'E016') or (TG_gumgin.Cells[7,I] = 'C036')
                   or (TG_gumgin.Cells[7,I] = 'E022') or (TG_gumgin.Cells[7,I] = 'E041')
                   or (TG_gumgin.Cells[7,I] = 'E008') or (TG_gumgin.Cells[7,I] = 'S015')
                   or (TG_gumgin.Cells[7,I] = 'S014') or (TG_gumgin.Cells[7,I] = 'S013')
                   or (TG_gumgin.Cells[7,I] = 'S056') or (TG_gumgin.Cells[7,I] = 'E014')
                   or (TG_gumgin.Cells[7,I] = 'E013') or (TG_gumgin.Cells[7,I] = 'E012')
                   or (TG_gumgin.Cells[7,I] = 'E018') or (TG_gumgin.Cells[7,I] = 'S009')
                   or (TG_gumgin.Cells[7,I] = 'S053') or (TG_gumgin.Cells[7,I] = 'S054')
                   or (TG_gumgin.Cells[7,I] = 'SE09') or (TG_gumgin.Cells[7,I] = 'SE10')
                   or (TG_gumgin.Cells[7,I] = 'E045') or (TG_gumgin.Cells[7,I] = 'S055')
                   or (TG_gumgin.Cells[7,I] = 'E021') or (TG_gumgin.Cells[7,I] = 'E035')
                   or (TG_gumgin.Cells[7,I] = 'C015') or (TG_gumgin.Cells[7,I] = 'E025')
                   or (TG_gumgin.Cells[7,I] = 'E005') or (TG_gumgin.Cells[7,I] = 'SE16')
                   or (TG_gumgin.Cells[7,I] = 'S038') or (TG_gumgin.Cells[7,I] = 'SE38')
                   or (TG_gumgin.Cells[7,I] = 'U026') or (TG_gumgin.Cells[7,I] = 'C038')
                   or (TG_gumgin.Cells[7,I] = 'C015') or (TG_gumgin.Cells[7,I] = 'C054')
                   or (TG_gumgin.Cells[7,I] = 'S038') or (TG_gumgin.Cells[7,I] = 'SE38')
                   or (TG_gumgin.Cells[7,I] = 'C016') then
                      ParamByName('gubn_part').AsString  := '08'
              Else
                      ParamByName('gubn_part').AsString  := '';

              Active := True;
              if RecordCount > 0 then
              begin

                   if (copy(TG_gumgin.Cells[10,I], 1,8) = 'Negative') or (copy(TG_gumgin.Cells[10,I], 1,8) = 'negative') then
                      TG_gumgin.Cells[10,I] := '음성'
                   Else if (copy(TG_gumgin.Cells[10,I], 1,8) = 'Positive') or (copy(TG_gumgin.Cells[10,I], 1,8) = 'positive') then
                      TG_gumgin.Cells[10,I] := '양성'
                   Else if (copy(TG_gumgin.Cells[10,I], 1,15) = 'Weakly Positive') or (copy(TG_gumgin.Cells[10,I], 1,15) = 'weakly Positive') or
                           (copy(TG_gumgin.Cells[10,I], 1,9)  = 'Equivocal') then
                      TG_gumgin.Cells[10,I] := '약양성'
                   Else if (copy(TG_gumgin.Cells[10,I], 1,9) = 'Not found') then
                      TG_gumgin.Cells[10,I] := '음성';
                   UP_SVarMemSet(sIndex);

                   UV_vS001[sIndex] := TG_gumgin.Cells[0,I];
                   UV_vS002[sIndex] := TG_gumgin.Cells[3,I];
                   UV_vS003[sIndex] := TG_gumgin.Cells[4,I] + '-' + TG_gumgin.Cells[5,I];
                   UV_vS004[sIndex] := TG_gumgin.Cells[6,I];
                   UV_vS005[sIndex] := TG_gumgin.Cells[7,I];
                   UV_vS006[sIndex] := TG_gumgin.Cells[10,I];

                   UV_fGulkwa := '';
                   UV_fGulkwa1 := FieldByName('DESC_GLKWA1').AsString;
                   UV_fGulkwa2 := FieldByName('DESC_GLKWA2').AsString;
                   UV_fGulkwa3 := FieldByName('DESC_GLKWA3').AsString;
                   GF_HulGulkwa('2', UV_fGulkwa1, UV_fGulkwa2, UV_fGulkwa3, UV_fGulkwa);
                   sGlkwa := UV_fGulkwa;
                   //Active := False;

                   if sGlkwa = '' then
                   begin
                        for iTemp := 1 to 10 do
                            begin
                                 sGlkwa := sGlkwa + '                                                            ';
                            end; // end of for;
                   end; // end of if

                   // 1.C050                                   -------------------------01
                   if TG_gumgin.Cells[7,I] = 'C050' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                             + Copy(sGlkwa, 229, Length(sGlkwa))
                   // 2.C051
                   Else if TG_gumgin.Cells[7,I] = 'C051' then
                        sGlkwa := Copy(sGlkwa, 1, 228) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 235, Length(sGlkwa))
                   // 3.C052
                   Else if TG_gumgin.Cells[7,I] = 'C052' then
                        sGlkwa := Copy(sGlkwa, 1, 234) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 241, Length(sGlkwa))
                   // 4.C065
                   Else if TG_gumgin.Cells[7,I] = 'C065' then
                        sGlkwa := Copy(sGlkwa, 1, 276) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 283, Length(sGlkwa))
                   // C070
                   Else if TG_gumgin.Cells[7,I] = 'C070' then
                        sGlkwa := Copy(sGlkwa, 1, 312) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 319, Length(sGlkwa))
                   // C081
                   Else if TG_gumgin.Cells[7,I] = 'C081' then
                        sGlkwa := Copy(sGlkwa, 1, 372) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 379, Length(sGlkwa))
                   // C072
                   Else if TG_gumgin.Cells[7,I] = 'C072' then
                        sGlkwa := Copy(sGlkwa, 1, 318) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 325, Length(sGlkwa))
                   // C083
                   Else if TG_gumgin.Cells[7,I] = 'C083' then
                        sGlkwa := Copy(sGlkwa, 1, 384) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 391, Length(sGlkwa))
                   // C053
                   Else if TG_gumgin.Cells[7,I] = 'C053' then
                        sGlkwa := Copy(sGlkwa, 1, 240) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 247, Length(sGlkwa))

                   // 5.H027                                   -------------------------02
                   Else if TG_gumgin.Cells[7,I] = 'H027' then
                        sGlkwa := Copy(sGlkwa, 1, 150) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 157, Length(sGlkwa))
                   // 6.H028
                   Else if TG_gumgin.Cells[7,I] = 'H028' then
                        sGlkwa := Copy(sGlkwa, 1, 156) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 163, Length(sGlkwa))
                   // H029
                   Else if TG_gumgin.Cells[7,I] = 'H029' then
                        sGlkwa := Copy(sGlkwa, 1, 162) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 169, Length(sGlkwa))
                   // H038
                   Else if TG_gumgin.Cells[7,I] = 'H038' then
                        sGlkwa := Copy(sGlkwa, 1, 216) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 223, Length(sGlkwa))
                   // H039
                   Else if TG_gumgin.Cells[7,I] = 'H039' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                   // H046
                   Else if TG_gumgin.Cells[7,I] = 'H046' then
                        sGlkwa := Copy(sGlkwa, 1, 228) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 235, Length(sGlkwa))

                   // 7.U027                                    -------------------------03
                   Else if TG_gumgin.Cells[7,I] = 'U027' then
                        sGlkwa := Copy(sGlkwa, 1, 168) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 175, Length(sGlkwa))
                   // U023
                   Else if TG_gumgin.Cells[7,I] = 'U023' then
                        sGlkwa := Copy(sGlkwa, 1, 138) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 145, Length(sGlkwa))
                   // U028
                   Else if TG_gumgin.Cells[7,I] = 'U028' then
                        sGlkwa := Copy(sGlkwa, 1, 162) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 169, Length(sGlkwa))
                   // U037
                   Else if TG_gumgin.Cells[7,I] = 'U037' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                   // U043
                   Else if TG_gumgin.Cells[7,I] = 'U043' then
                        sGlkwa := Copy(sGlkwa, 1, 270) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 277, Length(sGlkwa))
                   // U034
                   Else if TG_gumgin.Cells[7,I] = 'U034' then
                        sGlkwa := Copy(sGlkwa, 1, 204) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 211, Length(sGlkwa))
                   // U015
                   Else if TG_gumgin.Cells[7,I] = 'U015' then
                        sGlkwa := Copy(sGlkwa, 1, 102) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 109, Length(sGlkwa))
                   // U016
                   Else if TG_gumgin.Cells[7,I] = 'U016' then
                        sGlkwa := Copy(sGlkwa, 1, 108) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 115, Length(sGlkwa))
                   // U062
                   Else if TG_gumgin.Cells[7,I] = 'U062' then
                        sGlkwa := Copy(sGlkwa, 1, 390) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 398, Length(sGlkwa))
                   //Y005
                   Else if TG_gumgin.Cells[7,I] = 'Y005' then
                        sGlkwa := Copy(sGlkwa, 1, 90) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 97, Length(sGlkwa))
                   //Y008
                   Else if TG_gumgin.Cells[7,I] = 'Y008' then
                        sGlkwa := Copy(sGlkwa, 1, 234) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 241, Length(sGlkwa))
                   // U066
                   Else if TG_gumgin.Cells[7,I] = 'U066' then
                        sGlkwa := Copy(sGlkwa, 1, 415) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 422, Length(sGlkwa))
                   // U067
                   Else if TG_gumgin.Cells[7,I] = 'U067' then
                        sGlkwa := Copy(sGlkwa, 1, 421) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 428, Length(sGlkwa))
                   // U068
                   Else if TG_gumgin.Cells[7,I] = 'U068' then
                        sGlkwa := Copy(sGlkwa, 1, 427) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 434, Length(sGlkwa))
                   // U069
                   Else if TG_gumgin.Cells[7,I] = 'U069' then
                        sGlkwa := Copy(sGlkwa, 1, 433) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 440, Length(sGlkwa))
                   //U070
                   Else if TG_gumgin.Cells[7,I] = 'U070' then
                        sGlkwa := Copy(sGlkwa, 1, 439) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 446, Length(sGlkwa))
                   //U071
                   Else if TG_gumgin.Cells[7,I] = 'U071' then
                        sGlkwa := Copy(sGlkwa, 1, 445) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 452, Length(sGlkwa))
                   //U047
                   Else if TG_gumgin.Cells[7,I] = 'U047' then
                        sGlkwa := Copy(sGlkwa, 1, 294) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 301, Length(sGlkwa))

                   //U045
                   Else if TG_gumgin.Cells[7,I] = 'U045' then
                        sGlkwa := Copy(sGlkwa, 1, 282) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 289, Length(sGlkwa))
                   //U074
                   Else if TG_gumgin.Cells[7,I] = 'U074' then
                        sGlkwa := Copy(sGlkwa, 1, 463) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 470, Length(sGlkwa))

                   // 8.T005                                    -------------------------04
                   Else if TG_gumgin.Cells[7,I] = 'T005' then
                        sGlkwa := Copy(sGlkwa, 1, 54) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 61, Length(sGlkwa))
                   // 9.SE13
                   Else if TG_gumgin.Cells[7,I] = 'SE13' then
                        sGlkwa := Copy(sGlkwa, 1, 78) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 85, Length(sGlkwa))
                   // 11.SE11
                   Else if TG_gumgin.Cells[7,I] = 'SE11' then
                        sGlkwa := Copy(sGlkwa, 1, 66) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 73, Length(sGlkwa))
                   //C044
                   Else if TG_gumgin.Cells[7,I] = 'C044' then
                        sGlkwa := GF_RPad(TG_gumgin.Cells[10,I], 6, ' ') + Copy(sGlkwa, 7, Length(sGlkwa))

                   //E049
                   Else if TG_gumgin.Cells[7,I] = 'E049' then
                        sGlkwa := Copy(sGlkwa, 1, 162) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 169, Length(sGlkwa))
                   //T044
                   Else if TG_gumgin.Cells[7,I] = 'T044' then
                        sGlkwa := Copy(sGlkwa, 1, 180) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 187, Length(sGlkwa))
                   //T045
                   Else if TG_gumgin.Cells[7,I] = 'T045' then
                        sGlkwa := Copy(sGlkwa, 1, 186) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 193, Length(sGlkwa))
                   //T046
                   Else if TG_gumgin.Cells[7,I] = 'T046' then
                        sGlkwa := Copy(sGlkwa, 1, 192) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 199, Length(sGlkwa))
                   //T047
                   Else if TG_gumgin.Cells[7,I] = 'T047' then
                        sGlkwa := Copy(sGlkwa, 1, 198) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 205, Length(sGlkwa))
                   //T048
                   Else if TG_gumgin.Cells[7,I] = 'T048' then
                        sGlkwa := Copy(sGlkwa, 1, 204) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 211, Length(sGlkwa))
                   //T049
                   Else if TG_gumgin.Cells[7,I] = 'T049' then
                        sGlkwa := Copy(sGlkwa, 1, 210) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 217, Length(sGlkwa))
                    //E019
                   Else if TG_gumgin.Cells[7,I] = 'E019' then
                        sGlkwa := Copy(sGlkwa, 1, 108) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 115, Length(sGlkwa))
                    //T051
                   Else if TG_gumgin.Cells[7,I] = 'T051' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                    //T052
                   Else if TG_gumgin.Cells[7,I] = 'T052' then
                        sGlkwa := Copy(sGlkwa, 1, 228) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 235, Length(sGlkwa))
                    //T053
                   Else if TG_gumgin.Cells[7,I] = 'T053' then
                        sGlkwa := Copy(sGlkwa, 1, 234) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 241, Length(sGlkwa))
                    //T054
                   Else if TG_gumgin.Cells[7,I] = 'T054' then
                        sGlkwa := Copy(sGlkwa, 1, 240) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 247, Length(sGlkwa))
                   //T056
                   Else if TG_gumgin.Cells[7,I] = 'T056' then
                        sGlkwa := Copy(sGlkwa, 1, 246) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 253, Length(sGlkwa))
                   //T057
                   Else if TG_gumgin.Cells[7,I] = 'T057' then
                        sGlkwa := Copy(sGlkwa, 1, 252) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 259, Length(sGlkwa))
                   //E050
                   Else if TG_gumgin.Cells[7,I] = 'E050' then
                        sGlkwa := Copy(sGlkwa, 1, 168) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 175, Length(sGlkwa))

                   //T059
                   Else if TG_gumgin.Cells[7,I] = 'T059' then
                        sGlkwa := Copy(sGlkwa, 1, 264) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 271, Length(sGlkwa))


                   //T023
                   Else if TG_gumgin.Cells[7,I] = 'T023' then
                        sGlkwa := Copy(sGlkwa, 1, 126) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 133, Length(sGlkwa))

                  //S030
                  Else if TG_gumgin.Cells[7,I] = 'S030' then
                        sGlkwa := Copy(sGlkwa, 1,30) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                                + Copy(sGlkwa, 37, Length(sGlkwa))

                  //S031
                  Else if TG_gumgin.Cells[7,I] = 'S031' then
                        sGlkwa := Copy(sGlkwa, 1,42) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                                + Copy(sGlkwa, 49, Length(sGlkwa))


                   // 12.S078                                   -------------------------05
                   Else if TG_gumgin.Cells[7,I] = 'S078' then
                        sGlkwa := Copy(sGlkwa, 1, 156) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 163, Length(sGlkwa))
                   // 13.C020
                   Else if TG_gumgin.Cells[7,I] = 'C020' then
                        sGlkwa := Copy(sGlkwa, 1,  66) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 73, Length(sGlkwa))
                   // 14.C035
                   Else if TG_gumgin.Cells[7,I] = 'C035' then
                        sGlkwa := Copy(sGlkwa, 1,  84) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 91, Length(sGlkwa))
                   // 15.S010
                   Else if TG_gumgin.Cells[7,I] = 'S010' then
                        sGlkwa := Copy(sGlkwa, 1,  36) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 43, Length(sGlkwa))
                   // 16.S077
                   Else if TG_gumgin.Cells[7,I] = 'S077' then
                        sGlkwa := Copy(sGlkwa, 1, 120) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 127, Length(sGlkwa))
                  { // 17.C031
                   Else if TG_gumgin.Cells[7,I] = 'C031' then
                        sGlkwa := Copy(sGlkwa, 1, 60) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 67, Length(sGlkwa))       }
                   // 18.S019
                   Else if TG_gumgin.Cells[7,I] = 'S019' then
                        sGlkwa := Copy(sGlkwa, 1,  78) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 85, Length(sGlkwa))
                   // 19.S018
                   Else if TG_gumgin.Cells[7,I] = 'S018' then
                        sGlkwa := Copy(sGlkwa, 1,  72) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 79, Length(sGlkwa))
                   // 20.SE28
                   Else if TG_gumgin.Cells[7,I] = 'SE28' then
                        sGlkwa := Copy(sGlkwa, 1, 108) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 115, Length(sGlkwa))
                   // 21.SE27
                   Else if TG_gumgin.Cells[7,I] = 'SE27' then
                        sGlkwa := Copy(sGlkwa, 1, 144) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 151, Length(sGlkwa))
                   // 22.SE26
                   Else if TG_gumgin.Cells[7,I] = 'SE26' then
                        sGlkwa := Copy(sGlkwa, 1,  96) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 103, Length(sGlkwa))
                   // 23.SE29
                   Else if TG_gumgin.Cells[7,I] = 'SE29' then
                        sGlkwa := Copy(sGlkwa, 1, 150) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 157, Length(sGlkwa))
                   // T034
                   Else if TG_gumgin.Cells[7,I] = 'T034' then
                        sGlkwa := Copy(sGlkwa, 1, 228) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 235, Length(sGlkwa))
                   // T035
                   Else if TG_gumgin.Cells[7,I] = 'T035' then
                        sGlkwa := Copy(sGlkwa, 1, 234) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 241, Length(sGlkwa))
                   // T038
                   Else if TG_gumgin.Cells[7,I] = 'T038' then
                        sGlkwa := Copy(sGlkwa, 1, 306) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 313, Length(sGlkwa))
                   // E051
                   Else if TG_gumgin.Cells[7,I] = 'E051' then
                        sGlkwa := Copy(sGlkwa, 1, 258) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 265, Length(sGlkwa))
                   // E052
                   Else if TG_gumgin.Cells[7,I] = 'E052' then
                        sGlkwa := Copy(sGlkwa, 1, 264) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 271, Length(sGlkwa))
                   // E055
                   Else if TG_gumgin.Cells[7,I] = 'E055' then
                        sGlkwa := Copy(sGlkwa, 1, 282) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 289, Length(sGlkwa))
                   // E056
                   Else if TG_gumgin.Cells[7,I] = 'E056' then
                        sGlkwa := Copy(sGlkwa, 1, 288) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 295, Length(sGlkwa))
                   // S022
                   Else if TG_gumgin.Cells[7,I] = 'S022' then
                        sGlkwa := Copy(sGlkwa, 1,  90) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 97, Length(sGlkwa))
                   // T039
                   Else if TG_gumgin.Cells[7,I] = 'T039' then
                        sGlkwa := Copy(sGlkwa, 1, 312) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 319, Length(sGlkwa))
                   // S021
                   Else if TG_gumgin.Cells[7,I] = 'S021' then
                        sGlkwa := Copy(sGlkwa, 1,  42) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 49, Length(sGlkwa))
                   // T043
                   Else if TG_gumgin.Cells[7,I] = 'T043' then
                        sGlkwa := Copy(sGlkwa, 1, 360) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 367, Length(sGlkwa))
                    // S086
                   Else if TG_gumgin.Cells[7,I] = 'S086' then
                        sGlkwa := Copy(sGlkwa, 1, 318) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 325, Length(sGlkwa))
                   // S087
                   Else if TG_gumgin.Cells[7,I] = 'S087' then
                        sGlkwa := Copy(sGlkwa, 1, 324) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 331, Length(sGlkwa))
                   // S088
                   Else if TG_gumgin.Cells[7,I] = 'S088' then
                        sGlkwa := Copy(sGlkwa, 1, 330) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 337, Length(sGlkwa))
                   // S089
                   Else if TG_gumgin.Cells[7,I] = 'S089' then
                        sGlkwa := Copy(sGlkwa, 1, 336) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 343, Length(sGlkwa))
                   // E053
                   Else if TG_gumgin.Cells[7,I] = 'E053' then
                        sGlkwa := Copy(sGlkwa, 1, 270) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 277, Length(sGlkwa))
                   // E065
                   Else if TG_gumgin.Cells[7,I] = 'E065' then
                        sGlkwa := Copy(sGlkwa, 1, 408) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 415, Length(sGlkwa))
                   // E066
                   Else if TG_gumgin.Cells[7,I] = 'E066' then
                        sGlkwa := Copy(sGlkwa, 1, 414) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 421, Length(sGlkwa))
                   // E067
                   Else if TG_gumgin.Cells[7,I] = 'E067' then
                        sGlkwa := Copy(sGlkwa, 1, 420) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 427, Length(sGlkwa))
                   // T033
                   Else if TG_gumgin.Cells[7,I] = 'T033' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                   // T055
                   Else if TG_gumgin.Cells[7,I] = 'T055' then
                        sGlkwa := Copy(sGlkwa, 1, 366) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 374, Length(sGlkwa))
                   // E058
                   Else if TG_gumgin.Cells[7,I] = 'E058' then
                        sGlkwa := Copy(sGlkwa, 1, 300) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 307, Length(sGlkwa))
                   //S085
                   Else if TG_gumgin.Cells[7, I] = 'S085' then
                        sGlkwa := Copy(sGlkwa, 1, 174) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 181, Length(sGlkwa))
                   // E047
                   Else if TG_gumgin.Cells[7,I] = 'E047' then
                        sGlkwa := Copy(sGlkwa, 1, 138) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 145, Length(sGlkwa))
                   //E054
                   Else if TG_gumgin.Cells[7, I] = 'E054' then
                        sGlkwa := Copy(sGlkwa, 1, 276) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 283, Length(sGlkwa))
                   //T028
                   Else if TG_gumgin.Cells[7, I] = 'T028' then
                        sGlkwa := Copy(sGlkwa, 1, 192) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 199, Length(sGlkwa))
                   //T030
                   Else if TG_gumgin.Cells[7, I] = 'T030' then
                        sGlkwa := Copy(sGlkwa, 1, 204) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 211, Length(sGlkwa))

                   //S103
                   Else if TG_gumgin.Cells[7, I] = 'S103' then
                        sGlkwa := Copy(sGlkwa, 1, 480) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 486, Length(sGlkwa))

                   // 53.P007                                   -------------------------07
                   Else if TG_gumgin.Cells[7,I] = 'P007' then
                        sGlkwa := Copy(sGlkwa, 1,  96) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 103, Length(sGlkwa))
                   // S007
                   Else if TG_gumgin.Cells[7,I] = 'S007' then
                        sGlkwa := Copy(sGlkwa, 1,  30) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 37, Length(sGlkwa))
                   // S008
                   Else if TG_gumgin.Cells[7,I] = 'S008' then
                        sGlkwa := Copy(sGlkwa, 1,  36) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 43, Length(sGlkwa))
                   // S080
                   Else if TG_gumgin.Cells[7,I] = 'S080' then
                        sGlkwa := Copy(sGlkwa, 1,  90) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 97, Length(sGlkwa))
                   // S098
                   Else if TG_gumgin.Cells[7,I] = 'S098' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                   //S094
                   Else if TG_gumgin.Cells[7,I] = 'S094' then
                        sGlkwa := Copy(sGlkwa, 1, 198) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 205, Length(sGlkwa))
                   //S095
                   Else if TG_gumgin.Cells[7,I] = 'S095' then
                        sGlkwa := Copy(sGlkwa, 1, 204) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 211, Length(sGlkwa))
                   //S062
                   Else if TG_gumgin.Cells[7,I] = 'S062' then
                        sGlkwa := Copy(sGlkwa, 1, 156) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 163, Length(sGlkwa))
                   //S063
                   Else if TG_gumgin.Cells[7,I] = 'S063' then
                        sGlkwa := Copy(sGlkwa, 1, 162) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 169, Length(sGlkwa))

                   // 24.S066                                   -------------------------08
                   Else if TG_gumgin.Cells[7,I] = 'S066' then
                        sGlkwa := Copy(sGlkwa, 1, 486) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 493, Length(sGlkwa))
                   // 25.C037
                   Else if TG_gumgin.Cells[7,I] = 'C037' then
                        sGlkwa := Copy(sGlkwa, 1,  30) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 37, Length(sGlkwa))
                   // 26.S027
                   Else if TG_gumgin.Cells[7,I] = 'S027' then
                        sGlkwa := Copy(sGlkwa, 1, 216) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 223, Length(sGlkwa))
                   // 27.C040
                   Else if TG_gumgin.Cells[7,I] = 'C040' then
                        sGlkwa := Copy(sGlkwa, 1,  42) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 49, Length(sGlkwa))
                   // 28.T012
                   Else if TG_gumgin.Cells[7,I] = 'T012' then
                        sGlkwa := Copy(sGlkwa, 1, 504) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 511, Length(sGlkwa))
                   // 29.E027
                   Else if TG_gumgin.Cells[7,I] = 'E027' then
                        sGlkwa := Copy(sGlkwa, 1, 222) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 229, Length(sGlkwa))
                   // 30.S039
                   Else if TG_gumgin.Cells[7,I] = 'S039' then
                        sGlkwa := Copy(sGlkwa, 1, 378) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 385, Length(sGlkwa))
                   // 31.E010
                   Else if TG_gumgin.Cells[7,I] = 'E010' then
                        sGlkwa := Copy(sGlkwa, 1, 120) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 127, Length(sGlkwa))
                   // 32.E016
                   Else if TG_gumgin.Cells[7,I] = 'E016' then
                        sGlkwa := Copy(sGlkwa, 1, 156) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 163, Length(sGlkwa))
                   // 33.C036
                   Else if TG_gumgin.Cells[7,I] = 'C036' then
                        sGlkwa := Copy(sGlkwa, 1,  24) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 31, Length(sGlkwa))
                   // 34.E022
                   Else if TG_gumgin.Cells[7,I] = 'E022' then
                        sGlkwa := Copy(sGlkwa, 1, 192) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 199, Length(sGlkwa))
                   // 35.E041
                   Else if TG_gumgin.Cells[7,I] = 'E041' then
                        sGlkwa := Copy(sGlkwa, 1, 162) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 169, Length(sGlkwa))
                   // 36.E008
                   Else if TG_gumgin.Cells[7,I] = 'E008' then
                        sGlkwa := Copy(sGlkwa, 1, 108) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 115, Length(sGlkwa))
                   // 37.S015
                   Else if TG_gumgin.Cells[7,I] = 'S015' then
                        sGlkwa := Copy(sGlkwa, 1, 360) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 367, Length(sGlkwa))
                   // 38.S014
                   Else if TG_gumgin.Cells[7,I] = 'S014' then
                        sGlkwa := Copy(sGlkwa, 1, 354) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 361, Length(sGlkwa))
                   // 39.S013
                   Else if TG_gumgin.Cells[7,I] = 'S013' then
                        sGlkwa := Copy(sGlkwa, 1, 348) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 355, Length(sGlkwa))
                   // 40.S056
                   Else if TG_gumgin.Cells[7,I] = 'S056' then
                        sGlkwa := Copy(sGlkwa, 1, 480) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 487, Length(sGlkwa))
                   // 41.E014
                   Else if TG_gumgin.Cells[7,I] = 'E014' then
                        sGlkwa := Copy(sGlkwa, 1, 144) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 151, Length(sGlkwa))
                   // 42.E013
                   Else if TG_gumgin.Cells[7,I] = 'E013' then
                        sGlkwa := Copy(sGlkwa, 1, 138) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 145, Length(sGlkwa))
                   // 43.E012
                   Else if TG_gumgin.Cells[7,I] = 'E012' then
                        sGlkwa := Copy(sGlkwa, 1, 132) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 139, Length(sGlkwa))
                   // 44.E018
                   Else if TG_gumgin.Cells[7,I] = 'E018' then
                        sGlkwa := Copy(sGlkwa, 1, 168) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 175, Length(sGlkwa))
                   // 45.S009
                   Else if TG_gumgin.Cells[7,I] = 'S009' then
                        sGlkwa := Copy(sGlkwa, 1, 336) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 343, Length(sGlkwa))
                   // 46.S053
                   Else if TG_gumgin.Cells[7,I] = 'S053' then
                        sGlkwa := Copy(sGlkwa, 1, 462) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 469, Length(sGlkwa))
                   // 47.S054
                   Else if TG_gumgin.Cells[7,I] = 'S054' then
                        sGlkwa := Copy(sGlkwa, 1, 468) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 475, Length(sGlkwa))
                   // 48.SE09
                   Else if TG_gumgin.Cells[7,I] = 'SE09' then
                        sGlkwa := Copy(sGlkwa, 1, 438) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 445, Length(sGlkwa))
                   // 49.SE10
                   Else if TG_gumgin.Cells[7,I] = 'SE10' then
                        sGlkwa := Copy(sGlkwa, 1, 444) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 451, Length(sGlkwa))
                   // 50.E045
                   Else if TG_gumgin.Cells[7,I] = 'E045' then
                        sGlkwa := Copy(sGlkwa, 1, 252) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 259, Length(sGlkwa))
                   // 51.S055
                   Else if TG_gumgin.Cells[7,I] = 'S055' then
                        sGlkwa := Copy(sGlkwa, 1, 474) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 481, Length(sGlkwa))

                   // 52.E021
                   Else if TG_gumgin.Cells[7,I] = 'E021' then
                        sGlkwa := Copy(sGlkwa, 1, 186) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 193, Length(sGlkwa))
                   // 53.E035
                   Else if TG_gumgin.Cells[7,I] = 'E035' then
                        sGlkwa := Copy(sGlkwa, 1, 270) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 277, Length(sGlkwa))
                   // C015
                   Else if TG_gumgin.Cells[7,I] = 'C015' then
                        sGlkwa := Copy(sGlkwa, 1,   6) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 13, Length(sGlkwa))
                   // E025
                   Else if TG_gumgin.Cells[7,I] = 'E025' then
                        sGlkwa := Copy(sGlkwa, 1, 210) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 217, Length(sGlkwa))
                   // E005
                   Else if TG_gumgin.Cells[7,I] = 'E005' then
                        sGlkwa := Copy(sGlkwa, 1, 90) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 97, Length(sGlkwa))
                   //SE16
                   Else if TG_gumgin.Cells[7,I] = 'SE16' then
                        sGlkwa := Copy(sGlkwa, 1, 174) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 181, Length(sGlkwa))
                   //S038
                   Else if TG_gumgin.Cells[7,I] = 'S038' then
                        sGlkwa := Copy(sGlkwa, 1, 372) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 379, Length(sGlkwa))
                   //SE38
                   Else if TG_gumgin.Cells[7,I] = 'SE38' then
                        sGlkwa := Copy(sGlkwa, 1, 72) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 79, Length(sGlkwa))
                   //U026
                   Else if TG_gumgin.Cells[7,I] = 'U026' then
                        sGlkwa := Copy(sGlkwa, 1, 534) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 541, Length(sGlkwa))
                   //C038
                   Else if TG_gumgin.Cells[7,I] = 'C038' then
                        sGlkwa := Copy(sGlkwa, 1, 36) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 43, Length(sGlkwa))
                   //C015
                   Else if TG_gumgin.Cells[7,I] = 'C015' then
                        sGlkwa := Copy(sGlkwa, 1, 6) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 13, Length(sGlkwa))
                   //C054
                   Else if TG_gumgin.Cells[7,I] = 'C054' then
                        sGlkwa := Copy(sGlkwa, 1, 48) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 55, Length(sGlkwa))

                   //S038
                   Else if TG_gumgin.Cells[7,I] = 'S038' then
                        sGlkwa := Copy(sGlkwa, 1, 372) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 379, Length(sGlkwa))
                   //S038
                   Else if TG_gumgin.Cells[7,I] = 'SE38' then
                        sGlkwa := Copy(sGlkwa, 1, 72) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 79, Length(sGlkwa))

                   //C016
                   Else if TG_gumgin.Cells[7,I] = 'C016' then
                        sGlkwa := Copy(sGlkwa, 1, 12) + GF_RPad(TG_gumgin.Cells[10,I], 6, ' ')
                               + Copy(sGlkwa, 19, Length(sGlkwa));


                   sGlkwa := 'A' + sGlkwa;
                   sGlkwa := Trim(sGlkwa);
                   sGlkwa := Copy(sGlkwa, 2, Length(sGlkwa)-1);

                   UV_fGulkwa1 := '';
                   UV_fGulkwa2 := '';
                   UV_fGulkwa3 := '';
                   GF_HulGulkwa('1', UV_fGulkwa1, UV_fGulkwa2, UV_fGulkwa3, sGlkwa);

                   qryU_Gulkwa.ParamByName('COD_BJJS').AsString     := '15';
                   qryU_Gulkwa.ParamByName('DAT_BUNJU').AsString    := TG_gumgin.Cells[0,I];
                   qryU_Gulkwa.ParamByName('NUM_BUNJU').AsString    := TG_gumgin.Cells[3,I];
                   qryU_Gulkwa.ParamByName('DESC_GLKWA1').AsString  := UV_fGulkwa1;
                   qryU_Gulkwa.ParamByName('DESC_GLKWA2').AsString  := UV_fGulkwa2;
                   qryU_Gulkwa.ParamByName('DESC_GLKWA3').AsString  := UV_fGulkwa3;
                   qryU_Gulkwa.ParamByName('DAT_UPDATE').AsString   := GV_sToday;
                   qryU_Gulkwa.ParamByName('COD_UPDATE').AsString   := GV_sUserId;

                   //part구분
                   if    (TG_gumgin.Cells[7,I] = 'C050') or (TG_gumgin.Cells[7,I] = 'C051')
                      or (TG_gumgin.Cells[7,I] = 'C052') or (TG_gumgin.Cells[7,I] = 'C065')
                      or (TG_gumgin.Cells[7,I] = 'C070') or (TG_gumgin.Cells[7,I] = 'C081')
                      or (TG_gumgin.Cells[7,I] = 'C072') or (TG_gumgin.Cells[7,I] = 'C083')
                      or (TG_gumgin.Cells[7,I] = 'C053') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '01'
                   Else if (TG_gumgin.Cells[7,I] = 'H027') or (TG_gumgin.Cells[7,I] = 'H028')
                        or (TG_gumgin.Cells[7,I] = 'H029') or (TG_gumgin.Cells[7,I] = 'H038')
                        or (TG_gumgin.Cells[7,I] = 'H039') or (TG_gumgin.Cells[7,I] = 'H046') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '02'
                   Else if (TG_gumgin.Cells[7,I] = 'U023') or (TG_gumgin.Cells[7,I] = 'U027')
                        or (TG_gumgin.Cells[7,I] = 'U028') or (TG_gumgin.Cells[7,I] = 'U037')
                        or (TG_gumgin.Cells[7,I] = 'U043') or (TG_gumgin.Cells[7,I] = 'U034')
                        or (TG_gumgin.Cells[7,I] = 'U015') or (TG_gumgin.Cells[7,I] = 'U016')
                        or (TG_gumgin.Cells[7,I] = 'U062') or (TG_gumgin.Cells[7,I] = 'Y005')
                        or (TG_gumgin.Cells[7,I] = 'U066') or (TG_gumgin.Cells[7,I] = 'U067')
                        or (TG_gumgin.Cells[7,I] = 'U068') or (TG_gumgin.Cells[7,I] = 'U069')
                        or (TG_gumgin.Cells[7,I] = 'U070') or (TG_gumgin.Cells[7,I] = 'U071')
                        or (TG_gumgin.Cells[7,I] = 'Y008') or (TG_gumgin.Cells[7,I] = 'U047')
                        or (TG_gumgin.Cells[7,I] = 'U045') or (TG_gumgin.Cells[7,I] = 'U074') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '03'
                   Else if (TG_gumgin.Cells[7,I] = 'T005') or (TG_gumgin.Cells[7,I] = 'SE13')
                        or (TG_gumgin.Cells[7,I] = 'SE11')
                        or (TG_gumgin.Cells[7,I] = 'C044') or (TG_gumgin.Cells[7,I] = 'E019')
                        or (TG_gumgin.Cells[7,I] = 'E049') or (TG_gumgin.Cells[7,I] = 'T044')
                        or (TG_gumgin.Cells[7,I] = 'T045') or (TG_gumgin.Cells[7,I] = 'T046')
                        or (TG_gumgin.Cells[7,I] = 'T047') or (TG_gumgin.Cells[7,I] = 'T048')
                        or (TG_gumgin.Cells[7,I] = 'T049') or (TG_gumgin.Cells[7,I] = 'T051')
                        or (TG_gumgin.Cells[7,I] = 'T052') or (TG_gumgin.Cells[7,I] = 'T053')
                        or (TG_gumgin.Cells[7,I] = 'T054') or (TG_gumgin.Cells[7,I] = 'T056')
                        or (TG_gumgin.Cells[7,I] = 'T057') or (TG_gumgin.Cells[7,I] = 'T023')
                        or (TG_gumgin.Cells[7,I] = 'E050') or (TG_gumgin.Cells[7,I] = 'T059')
                        or (TG_gumgin.Cells[7,I] = 'S030') or (TG_gumgin.Cells[7,I] = 'S031') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '04'
                   Else if (TG_gumgin.Cells[7,I] = 'S078') or (TG_gumgin.Cells[7,I] = 'C020')
                        or (TG_gumgin.Cells[7,I] = 'C035') or (TG_gumgin.Cells[7,I] = 'S010')
                        or (TG_gumgin.Cells[7,I] = 'S077') or (TG_gumgin.Cells[7,I] = 'T055')
                        or (TG_gumgin.Cells[7,I] = 'S019') or (TG_gumgin.Cells[7,I] = 'S018')
                        or (TG_gumgin.Cells[7,I] = 'SE28') or (TG_gumgin.Cells[7,I] = 'SE27')
                        or (TG_gumgin.Cells[7,I] = 'SE26') or (TG_gumgin.Cells[7,I] = 'SE29')
                        or (TG_gumgin.Cells[7,I] = 'T034') or (TG_gumgin.Cells[7,I] = 'T035')
                        or (TG_gumgin.Cells[7,I] = 'T038') or (TG_gumgin.Cells[7,I] = 'E051')
                        or (TG_gumgin.Cells[7,I] = 'E052') or (TG_gumgin.Cells[7,I] = 'E055')
                        or (TG_gumgin.Cells[7,I] = 'E056') or (TG_gumgin.Cells[7,I] = 'S022')
                        or (TG_gumgin.Cells[7,I] = 'S086') or (TG_gumgin.Cells[7,I] = 'S087')
                        or (TG_gumgin.Cells[7,I] = 'S088') or (TG_gumgin.Cells[7,I] = 'S089')
                        or (TG_gumgin.Cells[7,I] = 'E053') or (TG_gumgin.Cells[7,I] = 'E065')
                        or (TG_gumgin.Cells[7,I] = 'E066') or (TG_gumgin.Cells[7,I] = 'E067')
                        or (TG_gumgin.Cells[7,I] = 'T033') or (TG_gumgin.Cells[7,I] = 'T039')
                        or (TG_gumgin.Cells[7,I] = 'S021') or (TG_gumgin.Cells[7,I] = 'T043')
                        or (TG_gumgin.Cells[7,I] = 'E058') or (TG_gumgin.Cells[7,I] = 'S085')
                        or (TG_gumgin.Cells[7,I] = 'E047') or (TG_gumgin.Cells[7,I] = 'E054')
                        OR (TG_gumgin.Cells[7,I] = 'T028') or (TG_gumgin.Cells[7,I] = 'T030')
                        or (TG_gumgin.Cells[7,I] = 'S103') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '05'
                   Else if (TG_gumgin.Cells[7,I] = 'P007') or (TG_gumgin.Cells[7,I] = 'S007')
                        or (TG_gumgin.Cells[7,I] = 'S008') or (TG_gumgin.Cells[7,I] = 'S080')
                        or (TG_gumgin.Cells[7,I] = 'S098') or (TG_gumgin.Cells[7,I] = 'S094')
                        or (TG_gumgin.Cells[7,I] = 'S095') or (TG_gumgin.Cells[7,I] = 'S062')
                        or (TG_gumgin.Cells[7,I] = 'S063') then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '07'
                   Else if (TG_gumgin.Cells[7,I] = 'S066') or (TG_gumgin.Cells[7,I] = 'C037')
                        or (TG_gumgin.Cells[7,I] = 'S027') or (TG_gumgin.Cells[7,I] = 'C040')
                        or (TG_gumgin.Cells[7,I] = 'T012') or (TG_gumgin.Cells[7,I] = 'E027')
                        or (TG_gumgin.Cells[7,I] = 'S039') or (TG_gumgin.Cells[7,I] = 'E010')
                        or (TG_gumgin.Cells[7,I] = 'E016') or (TG_gumgin.Cells[7,I] = 'C036')
                        or (TG_gumgin.Cells[7,I] = 'E022') or (TG_gumgin.Cells[7,I] = 'E041')
                        or (TG_gumgin.Cells[7,I] = 'E008') or (TG_gumgin.Cells[7,I] = 'S015')
                        or (TG_gumgin.Cells[7,I] = 'S014') or (TG_gumgin.Cells[7,I] = 'S013')
                        or (TG_gumgin.Cells[7,I] = 'S056') or (TG_gumgin.Cells[7,I] = 'E014')
                        or (TG_gumgin.Cells[7,I] = 'E013') or (TG_gumgin.Cells[7,I] = 'E012')
                        or (TG_gumgin.Cells[7,I] = 'E018') or (TG_gumgin.Cells[7,I] = 'S009')
                        or (TG_gumgin.Cells[7,I] = 'S053') or (TG_gumgin.Cells[7,I] = 'S054')
                        or (TG_gumgin.Cells[7,I] = 'SE09') or (TG_gumgin.Cells[7,I] = 'SE10')
                        or (TG_gumgin.Cells[7,I] = 'E045') or (TG_gumgin.Cells[7,I] = 'S055')
                        or (TG_gumgin.Cells[7,I] = 'E021') or (TG_gumgin.Cells[7,I] = 'E035')
                        or (TG_gumgin.Cells[7,I] = 'C015') or (TG_gumgin.Cells[7,I] = 'E025')
                        or (TG_gumgin.Cells[7,I] = 'E005') or (TG_gumgin.Cells[7,I] = 'SE16')
                        or (TG_gumgin.Cells[7,I] = 'S038') or (TG_gumgin.Cells[7,I] = 'SE38')
                        or (TG_gumgin.Cells[7,I] = 'U026') or (TG_gumgin.Cells[7,I] = 'C038')
                        or (TG_gumgin.Cells[7,I] = 'C015') or (TG_gumgin.Cells[7,I] = 'C054')
                        or (TG_gumgin.Cells[7,I] = 'S038') or (TG_gumgin.Cells[7,I] = 'SE38')
                        or (TG_gumgin.Cells[7,I] = 'C016')then
                           qryU_Gulkwa.ParamByName('gubn_part').AsString  := '08';

                   qryU_Gulkwa.Execsql;
                   GP_query_log(qryU_Gulkwa, 'LD3I07', 'Q', 'Y');
                   Inc(sIndex);

              end  //end od if;
              else
              begin
                   UP_SPVarMemSet(spIndex);

                   UV_vSP001[spIndex] := TG_gumgin.Cells[0,I];
                   UV_vSP002[spIndex] := TG_gumgin.Cells[3,I];
                   UV_vSP003[spIndex] := TG_gumgin.Cells[4,I] + '-' + TG_gumgin.Cells[5,I];
                   UV_vSP004[spIndex] := TG_gumgin.Cells[6,I];
                   UV_vSP005[spIndex] := TG_gumgin.Cells[7,I];
                   UV_vSP006[spIndex] := TG_gumgin.Cells[10,I];

                   Inc(spIndex);
              end; // end of else;
         end; // end of with;
         except
               on E : EDBEngineError do
                  begin
                       GF_MsgBox('Error', IntToStr(E.Errors[1].NativeError));
                       exit;
                  end; // end of except;
         end; // end of try;

   end; // end of for;

   qrdSList.Rows  := sIndex;
   qrdSPList.Rows  := spIndex;

end;

end.






